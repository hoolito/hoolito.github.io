// 海龟汤游戏数据
const gameData = {
    classic: [
        {
            story: "一个男人走进一家餐厅，点了一碗海龟汤。他喝了一口后，立刻冲出餐厅自杀了。为什么？",
            answer: "这个男人曾经在海上遇难，和朋友一起被困在荒岛上。朋友告诉他们在吃海龟肉维持生命，但实际上朋友把自己的肉割下来给他吃。后来获救后，男人在餐厅喝到真正的海龟汤，发现味道完全不同，这才意识到当时吃的是朋友的肉，朋友为了救他而牺牲了自己。",
            hints: [
                "这个男人以前喝过海龟汤",
                "他曾经和朋友一起遇到过危险",
                "朋友为了救他做出了巨大的牺牲"
            ]
        },
        {
            story: "一个女人每天晚上都会开着灯睡觉，但有一天晚上她关了灯，第二天早上就有很多人死了。为什么？",
            answer: "这个女人是灯塔管理员。她每天晚上都要开着灯塔的灯为过往船只指引方向。那天晚上她忘记开灯，导致船只撞上礁石，船上的人都死了。",
            hints: [
                "她的工作与很多人的安全有关",
                "这盏灯不是普通的房间灯",
                "她的疏忽导致了交通事故"
            ]
        },
        {
            story: "一个男人住在20楼，每天早上坐电梯下楼上班。晴天的时候他坐电梯到1楼，雨天的时候他坐电梯到10楼然后走楼梯。为什么？",
            answer: "这个男人是侏儒症患者，身高不够高。晴天时他可以用雨伞够到20楼的按钮，雨天时没有雨伞，只能够到10楼的按钮，所以要走楼梯上去。",
            hints: [
                "这与他的身体条件有关",
                "雨天和晴天他携带的物品不同",
                "电梯按钮的位置是关键"
            ]
        },
        {
            story: "一个女人在家里看电视，突然停电了。她摸黑走到厨房，打开冰箱，里面的灯亮了。她看了一眼就关上冰箱门，然后自杀了。为什么？",
            answer: "这个女人是盲人，她一直以为自己看得见。停电后她以为是眼睛出了问题，但当她看到冰箱里的灯时，才意识到自己一直都是盲人，无法接受这个事实。",
            hints: [
                "她对自己的身体状况有误解",
                "停电让她发现了真相",
                "冰箱的灯很重要"
            ]
        },
        {
             story: "一个男人每天都要喝一杯咖啡，但有一天他喝了咖啡后就死了。咖啡没有毒，他也没有过敏。为什么？",
             answer: "这个男人是糖尿病患者，每天都在咖啡里加胰岛素而不是糖。那天服务员误以为他要加糖，给他加了大量糖，导致血糖急剧升高而死亡。",
             hints: [
                 "他有特殊的疾病",
                 "咖啡里加的东西很重要",
                 "服务员犯了一个错误"
             ]
         },
         {
             story: "一个女人每天都会收到一束玫瑰花，但她从来不高兴。直到有一天没有收到花，她却笑了。为什么？",
             answer: "这个女人是花店老板，每天收到的玫瑰花是供货商送来的货物。那天没收到花是因为她终于可以休假了。",
             hints: [
                 "这些花与她的工作有关",
                 "收到花对她来说是负担",
                 "没收到花意味着特殊的日子"
             ]
         },
         {
             story: "一个男人在沙漠中发现了一个小屋，里面有53个人都死了，但没有任何外伤。为什么？",
             answer: "这是一架飞机的残骸，53个人是乘客和机组人员。飞机在沙漠中坠毁，所有人都在撞击中死亡。",
             hints: [
                 "这个'小屋'不是普通的建筑",
                 "53个人在同一时间死亡",
                 "这与交通工具有关"
             ]
         },
         {
             story: "一个女人站在窗前，看到一个男人从楼下走过。她立刻跳楼自杀了。为什么？",
             answer: "这个女人是盲人，她丈夫告诉她自己也是盲人。当她看到丈夫正常走路时，意识到丈夫一直在骗她，自己才是唯一的盲人。",
             hints: [
                 "她有视力问题",
                 "那个男人对她很重要",
                 "她发现了一个谎言"
             ]
         },
         {
             story: "一个男人每天晚上都会把车停在同一个地方，但有一天他换了地方停车，结果家里被盗了。为什么？",
             answer: "这个男人是警察，他每天把警车停在家门口起到震慑作用。那天他开私家车回家，小偷以为警察不在家就行窃了。",
             hints: [
                 "他的职业很特殊",
                 "他的车有特殊作用",
                 "车的存在能防止犯罪"
             ]
         },
         {
             story: "一个女人在餐厅吃饭时，服务员给她上了一道菜。她看了一眼就哭了，然后离开了餐厅。为什么？",
             answer: "这道菜是她已故母亲的拿手菜，她从来没有告诉过任何人配方。看到这道菜让她想起了母亲，情绪激动。",
             hints: [
                 "这道菜对她有特殊意义",
                 "这让她想起了某个重要的人",
                 "她没想到会在这里遇到这道菜"
             ]
         },
         {
             story: "一个男人每天都要按时吃药，但有一天他忘记吃药，结果救了很多人的命。为什么？",
             answer: "这个男人是飞行员，他吃的是安眠药。那天忘记吃药让他保持清醒，及时发现了飞机故障并成功迫降，救了所有乘客。",
             hints: [
                 "他的工作关系到很多人的安全",
                 "药物会影响他的状态",
                 "忘记吃药让他避免了危险"
             ]
         },
         {
             story: "一个女人每天都会收到一封匿名情书，但她从来没有见过写信的人。为什么？",
             answer: "这个女人患有健忘症，情书是她的丈夫写的，但她每天都会忘记。丈夫为了让她每天都能感受到被爱，所以每天都写匿名情书给她。",
             hints: [
                 "她有记忆方面的问题",
                 "写信的人她其实认识",
                 "这是出于爱的行为"
             ]
         },
         {
             story: "一个男人每天都会在公园里喂鸽子，但他从来不带鸽子食。为什么？",
             answer: "这个男人是个魔术师，他用魔术变出鸽子食来喂鸽子。这样既能练习魔术，又能做善事。",
             hints: [
                 "他有特殊的技能",
                 "食物是突然出现的",
                 "这与表演有关"
             ]
         },
         {
             story: "一个女人每天都会在同一时间听到门铃响，但开门后没有人。为什么？",
             answer: "她的邻居是个聋哑人，每天这个时间都会按她家门铃来确认时间，因为她家的门铃声音很特别，振动很明显。",
             hints: [
                 "按门铃的人有特殊需求",
                 "这与时间有关",
                 "门铃有特殊的功能"
             ]
         },
         {
             story: "一个男人每天都会收到一个空盒子，但他很高兴。为什么？",
             answer: "这个男人是个收藏家，专门收藏各种精美的空盒子。每天收到不同的盒子让他很开心。",
             hints: [
                 "他有特殊的爱好",
                 "盒子本身有价值",
                 "空盒子是他想要的"
             ]
         },
         {
             story: "一个女人每天都会在镜子前哭泣，但她很快乐。为什么？",
             answer: "她是个演员，每天都在练习哭戏。她热爱表演，所以即使在哭也很快乐。",
             hints: [
                 "她的职业需要这样做",
                 "哭泣是有目的的",
                 "这与表演有关"
             ]
         },
         {
             story: "一个男人每天都会把钱扔进垃圾桶，但他不是疯子。为什么？",
             answer: "他是银行的工作人员，负责销毁破损的纸币。这是他的工作职责。",
             hints: [
                 "这是他的工作",
                 "钱有问题不能使用",
                 "这是合法的行为"
             ]
         },
         {
            story: "一个女人每天都会收到一朵枯萎的花，但她很珍惜。为什么？",
            answer: "这朵花是她已故母亲生前最喜欢的花，她的父亲每天都会从母亲的墓地带一朵回来给她，作为母亲的思念。",
            hints: [
                "花有特殊的意义",
                "这与已故的人有关",
                "这是爱的表达"
            ]
        },
        {
            story: "一个男人每天都会在电话里和同一个人说话，但从来没见过面。为什么？",
            answer: "他是心理咨询师，每天都会给一个患有社交恐惧症的病人打电话进行治疗。病人不敢见面，只能通过电话交流。",
            hints: [
                "这是专业服务",
                "对方有特殊情况",
                "见面对对方来说很困难"
            ]
        },
         {
             story: "一个女人每天都会在同一时间打开收音机，但从来不听内容。有一天收音机坏了，她就死了。为什么？",
             answer: "这个女人是盲人，她通过收音机的声音来判断时间吃药。收音机坏了导致她错过了服药时间，病情恶化而死。",
             hints: [
                 "她有身体上的障碍",
                 "收音机帮助她掌握时间",
                 "按时做某件事对她很重要"
             ]
         },
         {
             story: "一个男人在图书馆里看书，突然站起来就走了，留下了一本血书。为什么？",
             answer: "这个男人有严重的鼻血问题，血滴在了书上。他意识到弄脏了图书馆的书，感到羞愧就离开了。",
             hints: [
                 "血不是故意弄上去的",
                 "他有健康问题",
                 "他因为弄脏书而感到不好意思"
             ]
         },
         {
             story: "一个女人每天都会收到同一个号码的电话，但从来不接。有一天她接了，然后就自杀了。为什么？",
             answer: "这是她已故儿子的电话号码，她一直保留着但不敢接。那天她终于接了，听到的是新用户的声音，意识到儿子真的永远不会再回来了。",
             hints: [
                 "这个电话号码对她有特殊意义",
                 "她失去了重要的人",
                 "接电话让她面对了现实"
             ]
         },
         {
             story: "一个男人在电影院看电影，突然大笑起来，然后就死了。电影不是喜剧。为什么？",
             answer: "这个男人是哑巴，他从来没有发出过声音。在电影院里他突然能够说话和笑了，但这是因为喉咙里的肿瘤破裂，很快就因为内出血而死亡。",
             hints: [
                 "他有语言障碍",
                 "能够发声对他来说是异常的",
                 "这种异常预示着危险"
             ]
         },
         {
             story: "一个女人每天都会在镜子前化妆，但有一天她看到镜子就砸碎了它。为什么？",
             answer: "这个女人患有精神分裂症，她在镜子里看到的不是自己，而是她幻想中的另一个人。那天她意识到这是幻觉，愤怒地砸碎了镜子。",
             hints: [
                 "她有精神方面的疾病",
                 "镜子里的影像不正常",
                 "她突然意识到了真相"
             ]
         },
         {
             story: "一个男人每天都会准时下班，但有一天他加班了，结果妻子就死了。为什么？",
             answer: "他的妻子患有严重的抑郁症，每天都在等他回家。他准时回家是妻子活下去的唯一动力，那天加班让妻子以为他不要她了，于是自杀了。",
             hints: [
                 "他的妻子有心理疾病",
                 "他的按时回家很重要",
                 "妻子把他的行为理解错了"
             ]
         },
         {
             story: "一个女人在超市买东西，看到价格标签就晕倒了。为什么？",
             answer: "这个女人有数字恐惧症，她害怕看到数字。平时都是别人帮她购物，那天她第一次自己去超市，看到价格数字就因为恐惧而晕倒了。",
             hints: [
                 "她有特殊的恐惧症",
                 "价格标签上的某些元素让她害怕",
                 "她平时避免这种情况"
             ]
         },
         {
             story: "一个男人在公园里喂鸽子，突然所有鸽子都飞走了，他也跟着跑了。为什么？",
             answer: "这个男人是逃犯，他通过观察鸽子的行为来判断是否有警察接近。鸽子突然飞走说明有人靠近，他意识到可能是警察就逃跑了。",
             hints: [
                 "他在躲避某些人",
                 "鸽子的行为是一种信号",
                 "他利用动物来预警"
             ]
         },
         {
             story: "一个女人每天都会写日记，但有一天她撕掉了所有日记，然后自杀了。为什么？",
             answer: "这个女人患有阿尔茨海默病，她通过日记来记住自己的生活。当她发现自己连日记都看不懂了，意识到病情严重恶化，选择了自杀。",
             hints: [
                 "她有记忆方面的疾病",
                 "日记对她很重要",
                 "她发现自己的能力在退化"
             ]
         },
         {
             story: "一个男人在餐厅点了一杯水，服务员给他端来后，他喝了一口就付钱离开了。为什么？",
             answer: "这个男人是品水师，他通过品尝水质来评估餐厅的卫生状况。那杯水的质量很差，他意识到这家餐厅有问题就离开了。",
             hints: [
                 "他有特殊的职业",
                 "水的质量很重要",
                 "他通过水判断了什么"
             ]
         },
         {
             story: "一个女人每天都会收到一封信，但从来不拆开。有一天邮递员没来，她就死了。为什么？",
             answer: "这个女人患有心脏病，每天收到信证明邮递员还活着，这是她活下去的动力。邮递员没来让她以为他死了，心情激动导致心脏病发作。",
             hints: [
                 "她有严重的疾病",
                 "邮递员的存在对她很重要",
                 "她的情绪影响了她的健康"
             ]
         },
         {
             story: "一个男人在理发店理发，理发师剪了一刀后，他就死了。为什么？",
             answer: "这个男人是血友病患者，任何小伤口都可能致命。理发师不小心剪破了他的皮肤，导致他因为无法止血而死亡。",
             hints: [
                 "他有血液方面的疾病",
                 "小伤口对他来说很危险",
                 "理发师犯了一个小错误"
             ]
         },
         {
             story: "一个女人在花园里浇花，突然扔掉水壶就跑了。为什么？",
             answer: "她在浇花时发现水壶里流出的不是水而是血，意识到有人在她的水源里做了手脚，害怕地逃跑了。",
             hints: [
                 "水壶里的液体不正常",
                 "她发现了危险的信号",
                 "有人想要伤害她"
             ]
         },
         {
             story: "一个男人每天都会按同一条路线上班，但有一天他改变了路线，结果迟到了但救了一命。为什么？",
             answer: "他平时走的路线那天发生了车祸，如果按原路线他会被撞死。改变路线虽然迟到了，但避免了死亡。",
             hints: [
                 "原路线发生了危险",
                 "改变路线避免了事故",
                 "时间和生命的权衡"
             ]
         },
         {
             story: "一个女人每天都会在同一时间收到一个电话，但从来不接。有一天她接了，然后就疯了。为什么？",
             answer: "这个女人是聋哑人，她从来听不到电话铃声。那天她'接'电话是因为看到电话在震动，但听筒里传来的声音让她意识到自己其实能听见，之前的聋哑是心理创伤造成的。",
             hints: [
                 "她有听力问题",
                 "她从来没有真正接过电话",
                 "听到声音对她来说很震惊"
             ]
         },
         {
             story: "一个男人每天都会在同一家咖啡店坐着，但从来不点任何东西。老板也不赶他走。为什么？",
             answer: "这个男人是咖啡店老板已故儿子的朋友，他每天来这里是为了陪伴老板，让老板感觉儿子还在身边。老板知道他的用意，所以从不赶他走。",
             hints: [
                 "他与老板有特殊关系",
                 "他的存在对老板很重要",
                 "这与失去的人有关"
             ]
         }
    ],
    mystery: [
        {
            story: "一个房间里有三个开关，控制隔壁房间的三盏灯。你只能进入隔壁房间一次，如何确定哪个开关控制哪盏灯？",
            answer: "先打开第一个开关几分钟，然后关掉，再打开第二个开关，然后进入房间。亮着的灯是第二个开关控制的，摸起来热的灯是第一个开关控制的，既不亮也不热的灯是第三个开关控制的。",
            hints: [
                "灯泡除了发光还会产生什么？",
                "你可以在进入房间前做一些操作",
                "时间是解题的关键"
            ]
        },
        {
            story: "一个人被发现死在完全密封的房间里，房间里只有一张桌子和一把椅子，没有任何工具。地上有一滩水。他是怎么死的？",
            answer: "他站在椅子上，把绳子系在天花板上准备上吊。他脚下放了一大块冰，等冰融化后，椅子就够不到了，他就被吊死了。地上的水就是冰融化后留下的。",
            hints: [
                "地上的水很重要",
                "他使用了一种会消失的东西",
                "温度变化是关键"
            ]
        },
        {
            story: "有5个海盗分100颗宝石，规则是最年长的海盗提出分配方案，如果超过半数同意就执行，否则他被扔进海里，由下一个年长的提出方案。假设所有海盗都足够聪明且贪婪，最年长的海盗应该如何分配？",
            answer: "最年长的海盗应该分配：自己98颗，第三年长的1颗，第五年长的1颗。这样第三和第五会支持他，加上自己的票就超过半数了。",
            hints: [
                "要考虑每个人的最优策略",
                "从最简单的情况开始推理",
                "关键是获得足够的支持票"
            ]
        },
        {
            story: "一个岛上有100个人，其中有些是蓝眼睛，有些是棕眼睛。岛上的规则是：如果有人知道自己的眼睛颜色，就必须在当晚离开。没有镜子，也不能互相告知眼睛颜色。有一天外来者说：'你们中至少有一个蓝眼睛的人。'会发生什么？",
            answer: "如果岛上有N个蓝眼睛的人，那么第N天晚上所有蓝眼睛的人都会离开。因为每个蓝眼睛的人都能看到N-1个蓝眼睛的人，当前N-1天没人离开时，他们就知道自己也是蓝眼睛。",
            hints: [
                "关键是公共知识的建立",
                "每个人都在观察别人的行为",
                "时间的推移会揭示信息"
            ]
        },
        {
            story: "有8个球，其中7个重量相同，1个稍重。用天平最少称几次能找出重球？",
            answer: "最少2次。第一次将8个球分成3组：3个、3个、2个，称3个球的两组。如果平衡，重球在2个球中，再称一次即可；如果不平衡，重球在重的那组3个球中，任选2个称一次，如果平衡则第3个是重球，如果不平衡则重的那个是重球。",
            hints: [
                "要充分利用天平的信息",
                "分组策略很重要",
                "考虑所有可能的情况"
            ]
        },
        {
            story: "一个国王要在1000个酒瓶中找出1瓶毒酒，毒酒会在1小时后致死。他有10个死囚可以试毒，如何在1小时内找出毒酒？",
            answer: "用二进制编码。给每个死囚编号1-10，对应二进制的10位。每瓶酒也用10位二进制编号，如果某位是1，就让对应的死囚喝这瓶酒。1小时后根据死囚的死亡情况，就能确定毒酒的二进制编号。",
            hints: [
                "要同时测试多瓶酒",
                "每个死囚可以喝多瓶酒",
                "用数学编码的思想"
            ]
        },
        {
            story: "有25匹马，5条跑道，没有计时器。最少比赛几次能找出最快的3匹马？",
            answer: "最少7次。前5次比赛每次5匹马，确定每组的排名。第6次让每组第一名比赛，确定最快的马。第7次比赛：第二快组的第一名、第二名，最快组的第二名、第三名，第三快组的第一名，这5匹马中最快的2匹就是第二、三名。",
            hints: [
                "要分组进行比赛",
                "利用已知信息排除不可能的马",
                "最快的马可以直接确定"
            ]
        },
        {
            story: "一个人有两根绳子，每根绳子燃烧完需要1小时，但燃烧速度不均匀。如何用这两根绳子测量45分钟？",
            answer: "同时点燃第一根绳子的两端和第二根绳子的一端。第一根绳子30分钟后烧完，此时点燃第二根绳子的另一端。第二根绳子剩余部分再烧15分钟就全部烧完，总共45分钟。",
            hints: [
                "可以从两端同时点燃",
                "两根绳子可以配合使用",
                "关键是30分钟+15分钟"
            ]
        },
        {
            story: "有100层楼，2个相同的玻璃球。要找出玻璃球不会摔碎的最高楼层，最少需要试验几次？",
            answer: "最少14次。采用递减策略：第一个球从14楼开始，如果碎了，第二个球从1楼逐层试到13楼；如果没碎，从27楼试（14+13），以此类推。这样最坏情况下需要14次试验。",
            hints: [
                "要平衡两个球的使用",
                "第一个球用来大范围定位",
                "间隔要逐渐减小"
            ]
        },
        {
            story: "有1000瓶药，其中1瓶是毒药。毒药会在24小时后致死，有10只老鼠可以试药。如何在24小时内找出毒药？",
            answer: "用二进制编码。1000瓶药需要10位二进制数表示（2^10=1024>1000）。给每只老鼠编号对应一个二进制位，如果药瓶编号的对应位是1，就让该老鼠喝这瓶药。24小时后根据老鼠的死亡情况确定毒药编号。",
            hints: [
                "每只老鼠可以喝多瓶药",
                "用数学编码方法",
                "10只老鼠可以表示1024种状态"
            ]
        },
        {
            story: "一个女人每天都会在图书馆里借同一本书，但从来不看。为什么？",
            answer: "这个女人是图书管理员，她每天借这本书是为了防止别人借走，因为这本书里夹着她和男友的情书，她不想被别人发现。",
            hints: [
                "她的职业与图书馆有关",
                "书里有重要的东西",
                "她在保护隐私"
            ]
        },
        {
            story: "一个男人每天都会在银行门口站一个小时，但从来不进去。为什么？",
            answer: "他是银行的安保人员，负责观察银行外部的可疑情况。他在门口站岗是为了预防抢劫等犯罪行为。",
            hints: [
                "他的工作与安全有关",
                "他在保护银行",
                "这是预防性措施"
            ]
        },
        {
            story: "一个女人每天都会买一张彩票，但从来不刮开。为什么？",
            answer: "她是彩票店的老板，买彩票是为了测试彩票机是否正常工作。她不刮开是因为这些彩票要退回给供应商。",
            hints: [
                "她与彩票店有关",
                "这是工作需要",
                "彩票有其他用途"
            ]
        },
        {
            story: "一个男人每天都会在公园里挖洞，但第二天又填上。为什么？",
            answer: "他是考古学家，在寻找古代文物。每天挖洞是为了探测，填上是为了保护现场，等待正式的挖掘许可。",
            hints: [
                "他在寻找什么",
                "这与历史有关",
                "他需要特殊许可"
            ]
        },
        {
            story: "一个女人每天都会在超市里买同样的东西，但从来不用。为什么？",
            answer: "她是超市的神秘顾客，负责检查商品质量和服务水平。买东西是为了测试，之后会退货或报销。",
            hints: [
                "她的工作与质量检查有关",
                "这是专业测试",
                "东西会被处理掉"
            ]
        },
        {
            story: "一个男人每天都会在医院里等候，但从来不看病。为什么？",
            answer: "他是医疗设备销售员，每天在医院等候是为了观察设备使用情况，寻找销售机会。",
            hints: [
                "他的工作与医院有关",
                "他在观察什么",
                "这与商业有关"
            ]
        },
        {
            story: "一个女人每天都会在邮局寄信，但信封里什么都没有。为什么？",
            answer: "她是邮政服务的测试员，寄空信封是为了测试邮递速度和服务质量。这是邮政系统的内部测试。",
            hints: [
                "这是测试工作",
                "她与邮政系统有关",
                "空信封有特殊目的"
            ]
        },
        {
            story: "一个男人每天都会在电影院买票，但从来不看电影。为什么？",
            answer: "他是电影院的管理员，买票是为了测试售票系统是否正常工作。这是日常的设备检查程序。",
            hints: [
                "他与电影院有关",
                "这是技术测试",
                "他在检查设备"
            ]
        },
        {
            story: "一个女人每天都会在餐厅点餐，但从来不吃。为什么？",
            answer: "她是美食评论家，点餐是为了观察餐厅的服务流程和食物外观。她会拍照记录，但不吃是因为要保持客观评价。",
            hints: [
                "她的工作与餐饮有关",
                "她在做专业评估",
                "吃东西会影响她的工作"
            ]
        },
        {
            story: "一个男人每天都会在加油站加油，但他没有车。为什么？",
            answer: "他是加油站设备维修工，每天加油是为了测试加油机是否正常工作。这是设备维护的标准程序。",
            hints: [
                "他的工作与设备有关",
                "这是技术检查",
                "他在测试机器"
            ]
        },
        {
            story: "一个女人每天都会在花店买花，但立刻就扔掉。为什么？",
            answer: "她是花店的质量检查员，买花是为了检查花的新鲜度和质量。扔掉是因为这些花已经完成了检测任务。",
            hints: [
                "她在检查质量",
                "这是专业工作",
                "花已经完成了使命"
            ]
        },
        {
            story: "一个男人每天都会在书店买书，但从来不读。为什么？",
            answer: "他是出版社的市场调研员，买书是为了研究竞争对手的产品和定价策略。这是商业情报收集工作。",
            hints: [
                "他的工作与出版有关",
                "这是市场研究",
                "他在收集信息"
            ]
        },
        {
            story: "一个女人每天都会在药店买药，但她很健康。为什么？",
            answer: "她是药品监管部门的检查员，买药是为了检查药店是否按规定销售处方药，是否有违规行为。",
            hints: [
                "她的工作与监管有关",
                "这是执法检查",
                "她在维护法规"
            ]
        },
        {
            story: "一个男人每天都会在ATM机前排队，但从来不取钱。为什么？",
            answer: "他是银行的安全顾问，观察ATM机的使用情况是为了评估安全风险，制定防范措施。",
            hints: [
                "他关注安全问题",
                "这是风险评估",
                "他在保护客户"
            ]
        },
        {
            story: "一个女人每天都会在咖啡店点咖啡，但从来不喝。为什么？",
            answer: "她是咖啡豆供应商的品质检查员，点咖啡是为了检查咖啡的香味和外观，确保供应的咖啡豆质量合格。",
            hints: [
                "她的工作与咖啡供应有关",
                "这是质量控制",
                "她在检查原料"
            ]
        },
        {
            story: "一个男人每天都会在停车场停车，但立刻就开走。为什么？",
            answer: "他是停车场设备测试员，停车是为了测试自动收费系统、车位感应器等设备是否正常工作。",
            hints: [
                "他在测试设备",
                "这与自动化系统有关",
                "他的工作是技术性的"
            ]
        },
        {
            story: "一个女人每天都会在健身房办卡，但从来不锻炼。为什么？",
            answer: "她是健身房连锁企业的神秘顾客，办卡是为了体验各个分店的服务质量和销售流程，为公司改进服务提供建议。",
            hints: [
                "她在评估服务",
                "这是商业调研",
                "她为企业工作"
            ]
        },
        {
            story: "一个男人每天都会在理发店理发，但头发从来不短。为什么？",
            answer: "他是假发制造商，每天'理发'实际上是在收集不同质量的头发作为制作假发的原料。理发师是他的合作伙伴。",
            hints: [
                "他在收集原料",
                "头发有商业价值",
                "这是合作关系"
            ]
        },
        {
            story: "一个女人每天都会在洗衣店洗衣服，但衣服都是干净的。为什么？",
            answer: "她是洗衣设备制造商的测试员，用干净衣服测试洗衣机的各项功能是否正常，包括水温、转速、清洁剂投放等。",
            hints: [
                "她在测试机器",
                "这是技术检验",
                "她与设备制造有关"
            ]
        },
        {
            story: "一个男人每天都会在宠物店买宠物食品，但他没有宠物。为什么？",
            answer: "他是动物收容所的志愿者，每天买宠物食品是为了喂养收容所里的流浪动物。这是他的爱心行为。",
            hints: [
                "他在帮助动物",
                "这是慈善行为",
                "动物在别的地方"
            ]
        }
    ],
    horror: [
        {
            story: "一个女孩每天晚上都能听到楼上传来弹珠掉落的声音，但楼上根本没有住人。为什么？",
            answer: "楼上住着一个失去双腿的老人，他每天晚上都要把假腿取下来，假腿掉在地上发出的声音就像弹珠一样。女孩以为楼上没人住，实际上老人行动不便，很少出门。",
            hints: [
                "楼上确实有人住",
                "那个人有身体上的不便",
                "声音来源于某种医疗用品"
            ]
        },
        {
            story: "一个男人每天都会收到一束鲜花，但他从来不知道是谁送的。直到有一天，他跟踪送花人，发现送花人走进了墓地。为什么？",
            answer: "送花人是墓地的工作人员，他每天都会把墓地里还新鲜的花收集起来，重新包装后送给活着的人，这样既不浪费又能让更多人感受到美好。男人收到的花实际上来自于墓地里的祭品。",
            hints: [
                "送花人的职业很特殊",
                "这些花之前有其他用途",
                "这是一种资源再利用"
            ]
        },
        {
            story: "一个女人每天晚上都会听到有人敲门，但开门后从来没有人。直到有一天她没听到敲门声，第二天就死了。为什么？",
            answer: "这个女人住在地下室，每天晚上的敲门声实际上是楼上邻居的脚步声。那天没有声音说明邻居出事了，没人发现她心脏病发作，所以她死了。",
            hints: [
                "声音的来源不是真的敲门",
                "她住的位置很特殊",
                "那个声音对她的安全很重要"
            ]
        },
        {
            story: "一个男人每天都会在镜子前刮胡子，但有一天他看到镜子里的自己没有在刮胡子，然后他就疯了。为什么？",
            answer: "这个男人患有严重的精神分裂症，镜子里的'自己'实际上是他的另一个人格。当他意识到自己无法控制另一个人格时，精神彻底崩溃了。",
            hints: [
                "他有精神方面的疾病",
                "镜子里的影像有问题",
                "他失去了对自己的控制"
            ]
        },
        {
            story: "一个女人每天都会收到一张照片，照片上是她自己在做各种事情，但她不记得拍过这些照片。为什么？",
            answer: "这个女人患有解离性身份障碍（多重人格），她的另一个人格在拍摄并发送这些照片。她不记得是因为人格转换时会失去记忆。",
            hints: [
                "她有记忆方面的问题",
                "拍照的人她认识",
                "她有多个身份"
            ]
        },
        {
            story: "一个男人每天晚上都会听到婴儿的哭声，但他家里没有婴儿。邻居也说没听到。为什么？",
            answer: "这个男人曾经意外杀死了一个婴儿，婴儿的哭声是他内疚产生的幻听。只有他能听到，因为这是他心理创伤的表现。",
            hints: [
                "只有他能听到这个声音",
                "他有心理创伤",
                "这与他的过去有关"
            ]
        },
        {
            story: "一个女人每天都会在同一时间收到一个电话，电话里只有呼吸声。有一天电话没响，她就自杀了。为什么？",
            answer: "打电话的是她植物人状态的儿子，医院每天定时让她听儿子的呼吸声。电话没响说明儿子死了，她无法承受失去儿子的痛苦。",
            hints: [
                "电话与她的家人有关",
                "呼吸声证明某人还活着",
                "没有电话意味着最坏的消息"
            ]
        },
        {
            story: "一个男人每天都会在墓地里和一个女人说话，但墓地管理员说从来没见过那个女人。为什么？",
            answer: "那个女人是他死去妻子的幻象，只存在于他的想象中。墓地管理员看到的只是一个男人在自言自语。",
            hints: [
                "那个女人只有他能看到",
                "他失去了重要的人",
                "他无法接受现实"
            ]
        },
        {
            story: "一个女人每天都会收到一封信，信里只写着一个日期。当那个日期到来时，她就死了。为什么？",
            answer: "那些信是她自己写的，她患有解离性身份障碍。她的另一个人格计划杀死主人格，并通过信件倒计时。",
            hints: [
                "信是她认识的人写的",
                "她有多重人格",
                "这是一个自我毁灭的计划"
            ]
        },
        {
            story: "一个男人每天都会看到一个小女孩在他家门口玩耍，但邻居们都说没有这个小女孩。为什么？",
            answer: "这个小女孩是他童年时意外杀死的玩伴的幻象。他一直被内疚折磨，产生了这种幻觉。",
            hints: [
                "只有他能看到这个女孩",
                "这与他的童年有关",
                "他有未解决的心理创伤"
            ]
        },
        {
            story: "一个女人每天都会在浴室里听到有人唱歌，但她独自居住。为什么？",
            answer: "她患有精神分裂症，听到的歌声是她的幻听。这些歌是她已故母亲常唱的，反映了她对母亲的思念和内心的孤独。",
            hints: [
                "她有精神方面的疾病",
                "歌声与她的回忆有关",
                "她感到非常孤独"
            ]
        },
        {
            story: "一个男人每天都会收到一张纸条，上面写着'我在看着你'。他报警后警察说没发现可疑人员。为什么？",
            answer: "纸条是他自己写的，他患有解离性身份障碍。他的另一个人格在监视和威胁主人格，但他自己不记得。",
            hints: [
                "写纸条的人他很熟悉",
                "他有记忆缺失",
                "他有多重人格"
            ]
        },
        {
            story: "一个女人每天都会在镜子里看到一个陌生男人，但转身后什么都没有。为什么？",
            answer: "这个女人患有精神分裂症，镜子里的男人是她的幻觉。这个男人的形象来自于她童年时遭受性侵的创伤记忆。",
            hints: [
                "她有精神疾病",
                "这个男人与她的创伤有关",
                "镜子触发了她的回忆"
            ]
        },
        {
            story: "一个男人每天都会听到有人在地下室里哭泣，但地下室是空的。为什么？",
            answer: "他曾经在地下室里囚禁并杀害了一个人，哭声是他内疚产生的幻听。这是他心理创伤的表现。",
            hints: [
                "地下室对他有特殊意义",
                "他做过可怕的事情",
                "哭声来自他的内疚"
            ]
        },
        {
            story: "一个女人每天都会收到一束白玫瑰，但花店老板说从来没有人订过这些花。为什么？",
            answer: "这些花是她自己买的，但她患有解离性身份障碍，不记得自己的行为。她的另一个人格在为主人格准备葬礼。",
            hints: [
                "她有记忆问题",
                "白玫瑰有特殊含义",
                "她有多重人格"
            ]
        },
        {
            story: "一个男人每天都会在同一个地方看到一辆红色汽车，但那里从来没有停车位。为什么？",
            answer: "那辆红色汽车是他撞死人时开的车，现在已经被销毁了。他看到的是内疚产生的幻觉，提醒他犯下的罪行。",
            hints: [
                "那辆车与他的过去有关",
                "车已经不存在了",
                "他做过违法的事情"
            ]
        },
        {
            story: "一个女人每天都会在窗户上看到一个手印，但她住在20楼。为什么？",
            answer: "那个手印是她自己留下的，她患有梦游症。她在梦游时会爬到窗外，试图跳楼自杀，但每次都被惊醒。",
            hints: [
                "手印是她自己的",
                "她有睡眠障碍",
                "她有自杀倾向"
            ]
        },
        {
            story: "一个男人每天都会收到一个包裹，里面是一块肉。但快递员说从来没有送过这样的包裹。为什么？",
            answer: "那块肉是他自己割下来的，他患有自残症和解离性身份障碍。他的另一个人格在惩罚主人格，但他不记得。",
            hints: [
                "肉来自他自己",
                "他有自残行为",
                "他有多重人格"
            ]
        },
        {
            story: "一个女人每天都会在床底下发现一张纸条，上面写着'今天又活过了一天'。为什么？",
            answer: "她患有严重的抑郁症和自杀倾向，每天晚上都想自杀。纸条是她的另一个人格写的，庆祝主人格又活过了一天。",
            hints: [
                "她有心理疾病",
                "纸条与生存有关",
                "她有多重人格"
            ]
        },
        {
            story: "一个男人每天都会在厨房里闻到烧焦的味道，但从来没有东西烧焦。为什么？",
            answer: "他曾经在厨房里烧死了自己的妻子，烧焦的味道是他内疚产生的幻嗅。这是他心理创伤的表现。",
            hints: [
                "厨房对他有特殊意义",
                "他失去了重要的人",
                "他做过可怕的事情"
            ]
        },
        {
            story: "一个女人每天都会收到一张自己睡觉时的照片，但她独自居住且门窗紧锁。为什么？",
            answer: "她患有解离性身份障碍，她的另一个人格在夜里拍摄这些照片。她不记得是因为人格转换时会失去记忆。",
            hints: [
                "拍照的人她认识",
                "她有记忆缺失",
                "她有多重人格"
            ]
        },
        {
            story: "一个男人每天都会在同一时间听到有人叫他的名字，但周围没有人。为什么？",
            answer: "他曾经杀死了一个一直叫他名字求救的人，现在这个声音是他内疚产生的幻听。只有他能听到。",
            hints: [
                "声音与他的过去有关",
                "他做过可怕的事情",
                "这是心理创伤的表现"
            ]
        },
        {
            story: "一个女人每天都会在衣柜里发现一件不属于她的衣服，但她独自居住。为什么？",
            answer: "她患有解离性身份障碍，那些衣服是她的另一个人格买的。她不记得购买过程，因为人格转换时会失去记忆。",
            hints: [
                "衣服是她买的",
                "她有记忆问题",
                "她有多重人格"
            ]
        },
        {
            story: "一个男人每天都会看到一个小男孩在他床边哭泣，但房间里没有小孩。为什么？",
            answer: "那个小男孩是他童年时的自己，他曾经被父亲虐待。现在看到的是他内心创伤的投射，代表他内心深处的痛苦。",
            hints: [
                "小男孩与他有关",
                "这与他的童年有关",
                "他有心理创伤"
            ]
        },
        {
            story: "一个女人每天都会收到一封信，信里详细描述她当天做过的事情，但她从来没告诉过任何人。为什么？",
            answer: "她患有解离性身份障碍，信是她的另一个人格写的。那个人格在监视和记录主人格的行为。",
            hints: [
                "写信的人了解她的一切",
                "她有多重人格",
                "她被人监视着"
            ]
        },
        {
            story: "一个男人每天都会在墙上看到血手印，但用任何方法都擦不掉。为什么？",
            answer: "血手印是他的幻觉，来自于他曾经杀人时留下的手印。这是他内疚和恐惧产生的心理投射。",
            hints: [
                "手印只有他能看到",
                "这与他的罪行有关",
                "他有心理创伤"
            ]
        },
        {
            story: "一个女人每天都会听到有人在敲她的棺材，但她还活着。为什么？",
            answer: "她患有严重的抑郁症和死亡恐惧症，敲棺材的声音是她内心对死亡恐惧的表现。她觉得自己已经死了。",
            hints: [
                "她有心理疾病",
                "这与死亡恐惧有关",
                "声音来自她的内心"
            ]
        },
        {
            story: "一个男人每天都会收到一个包裹，里面是一颗人的牙齿。为什么？",
            answer: "牙齿是他自己的，他患有自残症和解离性身份障碍。他的另一个人格在拔掉他的牙齿并寄给主人格作为惩罚。",
            hints: [
                "牙齿来自他自己",
                "他有自残行为",
                "他有多重人格"
            ]
        },
        {
            story: "一个女人每天晚上都会听到楼上传来弹珠掉落的声音，但楼上根本没有住人。为什么？",
            answer: "楼上住着一个盲人老人，他每晚都会不小心掉落手中的弹珠。女人以为楼上没人住，是因为盲人老人行动很轻，从不发出脚步声。",
            hints: [
                "楼上确实有人住",
                "那个人有特殊情况",
                "弹珠声是真实的"
            ]
        },
        {
            story: "一个男人每天晚上都会在镜子前刷牙，但有一天他看到镜子里的自己没有在刷牙。为什么？",
            answer: "这个男人患有严重的精神分裂症，他以为自己在刷牙，但实际上只是在做刷牙的动作，手里根本没有牙刷。镜子反映的是真实情况。",
            hints: [
                "他的认知出现了问题",
                "镜子显示的是真实情况",
                "他以为自己在做某件事"
            ]
        }
    ]
};

// 游戏状态
let currentGame = {
    mode: '',
    questionIndex: 0,
    questions: [],
    hintsUsed: 0,
    maxHints: 3,
    conversationLog: []
};

// 初始化游戏
function initGame() {
    showScreen('game-selection');
    updateHintCounter();
}

// 开始游戏
function startGame(mode) {
    currentGame.mode = mode;
    currentGame.questionIndex = 0;
    currentGame.questions = [...gameData[mode]];
    currentGame.hintsUsed = 0;
    currentGame.conversationLog = [];
    
    // 随机打乱题目顺序
    shuffleArray(currentGame.questions);
    
    document.getElementById('current-mode').textContent = getModeDisplayName(mode);
    updateQuestionCounter();
    updateHintCounter();
    
    loadCurrentQuestion();
    showScreen('game-screen');
}

// 获取模式显示名称
function getModeDisplayName(mode) {
    const modeNames = {
        classic: '经典模式',
        mystery: '推理模式',
        horror: '恐怖模式'
    };
    return modeNames[mode] || mode;
}

// 加载当前问题
function loadCurrentQuestion() {
    const currentQuestion = currentGame.questions[currentGame.questionIndex];
    document.getElementById('story-text').textContent = currentQuestion.story;
    clearConversation();
    
    // 添加欢迎消息
    addToConversation('system', '欢迎来到海龟汤游戏！请仔细阅读故事，然后提出只能用"是"、"否"或"无关"回答的问题来推理出真相。');
}

// 提问
function askQuestion() {
    const questionInput = document.getElementById('user-question');
    const question = questionInput.value.trim();
    
    if (!question) {
        alert('请输入问题！');
        return;
    }
    
    // 添加用户问题到对话记录
    addToConversation('user', question);
    
    // 生成AI回答
    const answer = generateAnswer(question);
    addToConversation('ai', answer);
    
    // 清空输入框
    questionInput.value = '';
    
    // 滚动到最新对话
    scrollToBottom();
}

// 生成AI回答
function generateAnswer(question) {
    const currentQuestion = currentGame.questions[currentGame.questionIndex];
    const story = currentQuestion.story.toLowerCase();
    const answer = currentQuestion.answer.toLowerCase();
    const questionLower = question.toLowerCase();
    
    // 简单的关键词匹配逻辑
    const yesKeywords = [
        '死', '自杀', '朋友', '海龟汤', '以前', '喝过', '吃过',
        '灯塔', '船', '工作', '责任', '管理员',
        '身高', '矮', '够不到', '按钮', '雨伞',
        '热', '温度', '时间', '之前',
        '冰', '融化', '消失', '椅子',
        '假腿', '残疾', '老人', '医疗',
        '墓地', '工作人员', '祭品', '回收'
    ];
    
    const noKeywords = [
        '意外', '他杀', '中毒', '疾病',
        '普通', '家里', '房间',
        '正常人', '健康',
        '小孩', '动物', '真的弹珠',
        '爱慕者', '追求者', '恋人'
    ];
    
    // 检查是否包含肯定关键词
    for (let keyword of yesKeywords) {
        if (questionLower.includes(keyword) && answer.includes(keyword)) {
            return '是的。';
        }
    }
    
    // 检查是否包含否定关键词
    for (let keyword of noKeywords) {
        if (questionLower.includes(keyword)) {
            return '不是。';
        }
    }
    
    // 特殊问题处理
    if (questionLower.includes('为什么') || questionLower.includes('原因')) {
        return '这个问题太直接了，请尝试问一些更具体的细节问题。';
    }
    
    if (questionLower.includes('怎么') && questionLower.includes('死')) {
        return '请先了解更多背景信息。';
    }
    
    // 默认回答
    const randomResponses = [
        '无关。',
        '不是。',
        '是的。',
        '这个细节不重要。',
        '请换个角度思考。',
        '你的方向是对的，继续深入。'
    ];
    
    return randomResponses[Math.floor(Math.random() * randomResponses.length)];
}

// 添加对话记录
function addToConversation(type, message) {
    const conversationLog = document.getElementById('conversation-log');
    const conversationItem = document.createElement('div');
    conversationItem.className = `conversation-item ${type}`;
    
    const typeNames = {
        user: '你',
        ai: 'AI助手',
        system: '系统'
    };
    
    conversationItem.innerHTML = `
        <strong>${typeNames[type]}:</strong>
        ${message}
    `;
    
    conversationLog.appendChild(conversationItem);
    currentGame.conversationLog.push({ type, message });
}

// 滚动到底部
function scrollToBottom() {
    const conversationLog = document.getElementById('conversation-log');
    conversationLog.scrollTop = conversationLog.scrollHeight;
}

// 清空对话
function clearConversation() {
    document.getElementById('conversation-log').innerHTML = '';
    currentGame.conversationLog = [];
}

// 获取提示
function getHint() {
    if (currentGame.hintsUsed >= currentGame.maxHints) {
        alert('提示次数已用完！');
        return;
    }
    
    const currentQuestion = currentGame.questions[currentGame.questionIndex];
    const hint = currentQuestion.hints[currentGame.hintsUsed];
    
    document.getElementById('hint-text').textContent = hint;
    document.getElementById('hint-modal').style.display = 'block';
    
    currentGame.hintsUsed++;
    updateHintCounter();
}

// 关闭提示弹窗
function closeHintModal() {
    document.getElementById('hint-modal').style.display = 'none';
}

// 更新提示计数器
function updateHintCounter() {
    const remaining = currentGame.maxHints - currentGame.hintsUsed;
    document.getElementById('hint-count').textContent = remaining;
    
    const hintBtn = document.getElementById('hint-btn');
    if (remaining <= 0) {
        hintBtn.disabled = true;
    } else {
        hintBtn.disabled = false;
    }
}

// 显示答案
function showAnswer() {
    const currentQuestion = currentGame.questions[currentGame.questionIndex];
    document.getElementById('full-answer').textContent = currentQuestion.answer;
    showScreen('answer-screen');
}

// 下一题
function nextQuestion() {
    currentGame.questionIndex++;
    
    if (currentGame.questionIndex >= currentGame.questions.length) {
        // 游戏结束
        alert('恭喜你完成了所有题目！');
        backToSelection();
        return;
    }
    
    // 重置提示计数
    currentGame.hintsUsed = 0;
    updateHintCounter();
    updateQuestionCounter();
    
    loadCurrentQuestion();
    showScreen('game-screen');
}

// 重新开始游戏
function restartGame() {
    startGame(currentGame.mode);
}

// 返回选择界面
function backToSelection() {
    showScreen('game-selection');
}

// 回到首页
function goToHome() {
    if (currentGame.conversationLog.length > 0) {
        if (confirm('确定要回到首页吗？当前游戏进度将会丢失。')) {
            showScreen('game-selection');
            // 重置游戏状态
            currentGame = {
                mode: '',
                questionIndex: 0,
                questions: [],
                hintsUsed: 0,
                maxHints: 3,
                conversationLog: []
            };
        }
    } else {
        showScreen('game-selection');
    }
}

// 显示指定屏幕
function showScreen(screenId) {
    // 隐藏所有屏幕
    const screens = document.querySelectorAll('.screen');
    screens.forEach(screen => screen.classList.remove('active'));
    
    // 显示指定屏幕
    document.getElementById(screenId).classList.add('active');
}

// 更新问题计数器
function updateQuestionCounter() {
    const current = currentGame.questionIndex + 1;
    const total = currentGame.questions.length;
    document.getElementById('question-counter').textContent = `${current}/${total}`;
}

// 数组随机打乱
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

// 键盘事件处理
document.addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
        const userQuestion = document.getElementById('user-question');
        if (document.activeElement === userQuestion) {
            askQuestion();
        }
    }
    
    if (event.key === 'Escape') {
        closeHintModal();
    }
});

// 点击模态框外部关闭
document.getElementById('hint-modal').addEventListener('click', function(event) {
    if (event.target === this) {
        closeHintModal();
    }
});

// 页面加载完成后初始化
document.addEventListener('DOMContentLoaded', function() {
    initGame();
});

// 防止表单提交刷新页面
document.addEventListener('submit', function(event) {
    event.preventDefault();
});

// 添加触摸设备支持
if ('ontouchstart' in window) {
    document.body.classList.add('touch-device');
}

// 自动调整文本区域高度
function autoResize(textarea) {
    textarea.style.height = 'auto';
    textarea.style.height = textarea.scrollHeight + 'px';
}

// 添加一些额外的用户体验优化
window.addEventListener('beforeunload', function(event) {
    if (currentGame.conversationLog.length > 0) {
        event.preventDefault();
        event.returnValue = '你确定要离开吗？当前游戏进度将会丢失。';
    }
});

// 添加错误处理
window.addEventListener('error', function(event) {
    console.error('游戏发生错误:', event.error);
    alert('游戏发生了一个错误，请刷新页面重试。');
});

// 性能优化：防抖函数
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// 应用防抖到输入事件
const debouncedAskQuestion = debounce(askQuestion, 300);

// 添加加载状态
function showLoading(element) {
    element.disabled = true;
    element.innerHTML = '<span class="loading"></span> 思考中...';
}

function hideLoading(element, originalText) {
    element.disabled = false;
    element.innerHTML = originalText;
}