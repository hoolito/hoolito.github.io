<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥³å·«çš„æ¯’è¯ - ç¥ç§˜å¯¹å†³</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #e6e6e6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(139, 0, 139, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 90% 80%, rgba(0, 100, 0, 0.15) 0%, transparent 25%),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="none"/><path d="M20,20 Q40,5 60,20 T100,20 M20,50 Q40,35 60,50 T100,50 M20,80 Q40,65 60,80 T100,80" stroke="rgba(139,0,139,0.1)" stroke-width="0.5" fill="none"/></svg>');
            z-index: -1;
        }
        
        .header {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            border-bottom: 2px solid #8a2be2;
            width: 100%;
            max-width: 900px;
            position: relative;
        }
        
        h1 {
            font-size: 3.2rem;
            color: #ff6b6b;
            text-shadow: 0 0 15px rgba(255, 107, 107, 0.7);
            margin-bottom: 10px;
            letter-spacing: 3px;
            position: relative;
        }
        
        h1::after {
            content: "ğŸ§™â€â™€ï¸";
            position: absolute;
            top: -25px;
            left: 50px;
            font-size: 2.5rem;
            animation: float 3s ease-in-out infinite;
        }
        
        h1::before {
            content: "ğŸ§ª";
            position: absolute;
            top: -20px;
            right: 50px;
            font-size: 2rem;
            animation: float 4s ease-in-out infinite;
        }
        
        .subtitle {
            font-size: 1.3rem;
            color: #9a86cf;
            max-width: 700px;
            margin: 10px auto;
            line-height: 1.6;
        }
        
        .game-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            max-width: 1000px;
            width: 100%;
            margin-top: 20px;
        }
        
        .grid-container {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
            border: 3px solid #6a5acd;
            width: 500px;
        }
        
        .grid-title {
            text-align: center;
            color: #ff6b6b;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-shadow: 0 0 8px rgba(255, 107, 107, 0.5);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin: 0 auto;
        }
        
        .cell {
            width: 70px;
            height: 70px;
            background: rgba(40, 44, 52, 0.8);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 34px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #4b0082;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .cell::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, rgba(255,255,255,0.1) 100%);
            z-index: 1;
        }
        
        .cell:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            background: rgba(60, 64, 72, 0.9);
            z-index: 2;
        }
        
        /* æ­»æ³•æ ‡è®° - çº¢è‰²è¾¹æ¡† */
        .cell.death-selected {
            border: 3px solid #ff6b6b;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
        }
        
        /* å°¸æ£€æŠ¥å‘Šæ ‡è®° - ç´«è‰²è¾¹æ¡† */
        .cell.autopsy-selected {
            border: 3px solid #9370db;
            box-shadow: 0 0 15px rgba(147, 112, 219, 0.5);
        }
        
        /* ç©å®¶è¡ŒåŠ¨æ ‡è®° */
        .cell.player-move {
            background: rgba(70, 130, 180, 0.7);
        }
        
        .cell.player-move::after {
            content: "P";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 40px;
            font-weight: bold;
            color: rgba(255, 255, 255, 0.8);
            z-index: 2;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
        }
        
        /* ç³»ç»Ÿè¡ŒåŠ¨æ ‡è®° */
        .cell.system-move {
            background: rgba(178, 34, 34, 0.7);
        }
        
        .cell.system-move::after {
            content: "S";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 40px;
            font-weight: bold;
            color: rgba(255, 255, 255, 0.8);
            z-index: 2;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
        }
        
        .cell.revealed {
            cursor: default;
            transform: scale(0.95);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .controls-container {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
            border: 3px solid #6a5acd;
            width: 400px;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        label {
            font-size: 1.1rem;
            color: #9a86cf;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        label i {
            color: #ff6b6b;
        }
        
        input, textarea, select {
            padding: 14px;
            border-radius: 10px;
            border: 2px solid #4b0082;
            background: rgba(40, 44, 52, 0.8);
            color: #e6e6e6;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #8a2be2;
            box-shadow: 0 0 0 3px rgba(138, 43, 226, 0.3);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 10px;
        }
        
        button {
            padding: 14px 30px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(45deg, #6a5acd, #8a2be2);
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            background: linear-gradient(45deg, #8a2be2, #9370db);
        }
        
        button:disabled {
            background: #555;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.7;
        }
        
        .game-status {
            font-size: 1.4rem;
            text-align: center;
            padding: 15px;
            background: rgba(26, 26, 46, 0.8);
            border-radius: 15px;
            border: 2px solid #6a5acd;
            width: 100%;
            max-width: 900px;
            margin: 20px 0;
            color: #ffd700;
            font-weight: bold;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }
        
        .log-container {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
            border: 3px solid #6a5acd;
            width: 100%;
            max-width: 900px;
            margin-bottom: 20px;
        }
        
        .log {
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .log-title {
            color: #9a86cf;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .log-entry {
            margin: 12px 0;
            padding: 12px;
            border-left: 4px solid #8a2be2;
            background: rgba(40, 44, 52, 0.5);
            border-radius: 0 10px 10px 0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            animation: fadeIn 0.5s ease;
        }
        
        .player-log {
            border-left-color: #4682b4;
        }
        
        .system-log {
            border-left-color: #b22222;
        }
        
        .autopsy-log {
            border-left-color: #ffd700;
            background: rgba(40, 44, 52, 0.7);
        }
        
        .death-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            color: white;
            text-align: center;
            padding: 20px;
            display: none;
        }
        
        .death-content {
            background: rgba(26, 26, 46, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            border: 3px solid #8a2be2;
            box-shadow: 0 0 40px rgba(138, 43, 226, 0.7);
        }
        
        .death-message {
            font-size: 4rem;
            margin-bottom: 30px;
            color: #ff6b6b;
            text-shadow: 0 0 20px rgba(255, 0, 0, 0.8);
        }
        
        .death-reason {
            font-size: 1.8rem;
            margin-bottom: 40px;
            color: #ffd700;
            line-height: 1.6;
        }
        
        .instructions {
            max-width: 900px;
            margin: 30px auto;
            padding: 25px;
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            border: 3px solid #6a5acd;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .instructions h2 {
            color: #9a86cf;
            margin-bottom: 20px;
            text-align: center;
            font-size: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .instructions ul {
            padding-left: 30px;
            margin: 20px 0;
        }
        
        .instructions li {
            margin-bottom: 15px;
            line-height: 1.7;
            font-size: 1.1rem;
        }
        
        .emoji-preview {
            font-size: 1.5rem;
            margin-left: 5px;
            vertical-align: middle;
        }
        
        .example-container {
            background: rgba(40, 44, 52, 0.6);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .example {
            margin: 15px 0;
            padding: 15px;
            background: rgba(50, 54, 62, 0.7);
            border-radius: 10px;
            border-left: 4px solid #8a2be2;
        }
        
        .player-name {
            color: #4682b4;
            font-weight: bold;
        }
        
        .opponent-name {
            color: #b22222;
            font-weight: bold;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @media (max-width: 900px) {
            .game-container {
                flex-direction: column;
                align-items: center;
            }
            
            .grid-container, .controls-container {
                width: 100%;
                max-width: 600px;
            }
            
            h1 {
                font-size: 2.5rem;
            }
        }
        
        @media (max-width: 600px) {
            .cell {
                width: 55px;
                height: 55px;
                font-size: 28px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .death-message {
                font-size: 2.5rem;
            }
            
            .death-reason {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>å¥³å·«çš„æ¯’è¯ ğŸ§ª</h1>
        <p class="subtitle">åœ¨è¿™åœºç¥ç§˜çš„å¯¹å†³ä¸­ï¼Œè—å¥½ä½ è®¾ä¸‹çš„æ­»äº¡é™·é˜±ï¼Œå¯»æ‰¾å¯¹æ‰‹çš„è‡´å‘½é…æ–¹ï¼å°å¿ƒæ¯ä¸€æ­¥ï¼Œæ­»äº¡å¯èƒ½å°±å‘ç”Ÿåœ¨ä¸‹ä¸€ä¸ªemoji...</p>
    </div>
    
    <div class="game-status" id="gameStatus">é€‰æ‹©ä½ çš„æ­»æ³•å’Œå°¸æ£€æŠ¥å‘Šä½ç½®...</div>
    
    <!-- æ—¥å¿—å®¹å™¨ç§»åŠ¨åˆ°æç¤ºæ¡†å’Œææ–™åº“ä¹‹é—´ -->
    <div class="log-container">
        <h3 class="log-title"><i class="fas fa-scroll"></i> å¥³å·«çš„é­”æ³•æ—¥å¿—</h3>
        <div class="log" id="logEntries"></div>
    </div>
    
    <div class="game-container">
        <div class="grid-container">
            <div class="grid-title">ç¥ç§˜ææ–™åº“</div>
            <div class="grid" id="grid"></div>
        </div>
        
        <div class="controls-container">
            <div class="controls">
                <div class="control-group">
                    <label for="deathEmoji"><i class="fas fa-skull"></i> ä½ çš„æ­»æ³•ä½ç½®:</label>
                    <div style="display: flex; gap: 10px;">
                        <select id="deathEmoji" style="flex: 1;"></select>
                        <input type="text" id="deathDesc" placeholder="æè¿°æ­»äº¡åœºæ™¯" style="flex: 3;">
                    </div>
                </div>
                
                <div class="control-group">
                    <label for="autopsyEmoji"><i class="fas fa-file-medical"></i> å°¸æ£€æŠ¥å‘Šä½ç½®:</label>
                    <div style="display: flex; gap: 10px;">
                        <select id="autopsyEmoji" style="flex: 1;"></select>
                        <input type="text" id="autopsyDesc" placeholder="æè¿°è‡´æ­»åŸå› " style="flex: 3;">
                    </div>
                </div>
                
                <div class="buttons">
                    <button id="startBtn"><i class="fas fa-play"></i> å¼€å§‹æ¸¸æˆ</button>
                    <button id="resetBtn"><i class="fas fa-redo"></i> é‡æ–°å¼€å§‹</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="instructions">
        <h2><i class="fas fa-book"></i> æ¸¸æˆè§„åˆ™ä¸ç¤ºä¾‹</h2>
        
        <div class="example-container">
            <h3><i class="fas fa-lightbulb"></i> å‰§æœ¬ç¤ºä¾‹ï¼š</h3>
            
            <div class="example">
                <p><span class="player-name">å°æ˜</span>ä¸º<span class="opponent-name">å°ç»¿</span>å®‰æ’çš„å‰§æœ¬ï¼š</p>
                <p><strong>æ­»æ³•ğŸ¡ï¼š</strong>å»é¥­é¦†åƒæ²³è±šï¼Œæ­»äºæ²³è±šä¸­æ¯’</p>
                <p><strong>å°¸æ£€æŠ¥å‘Šâ™Ÿï¼š</strong>æ­»è€…æ­»äºæ‘„å…¥è‡´å‘½ç‰©è´¨</p>
            </div>
            
            <div class="example">
                <p><span class="player-name">å°ç»¿</span>ä¸º<span class="opponent-name">å°æ˜</span>å®‰æ’çš„å‰§æœ¬ï¼š</p>
                <p><strong>æ­»æ³•ğŸ§»ï¼š</strong>ä¸Šå•æ‰€æ—¶è¸©åˆ°åœ°ä¸Šçš„æ¹¿çº¸å·¾æ‘”æ­»</p>
                <p><strong>å°¸æ£€æŠ¥å‘ŠğŸ§¬ï¼š</strong>æ­»è€…æ­»äºæ‘”å€’åå¤´éƒ¨ç€åœ°</p>
            </div>
        </div>
        
        <div class="example-container">
            <h3><i class="fas fa-gamepad"></i> æ¸¸æˆè¿‡ç¨‹ç¤ºä¾‹ï¼š</h3>
            
            <div class="example">
                <p><span class="player-name">å°æ˜</span>é€‰æ‹©<span class="emoji-preview">â™Ÿ</span>ï¼šä»Šå¤©å»ä¸‹æ£‹äº†ï¼Œè¾“äº†</p>
                <p>â†’ <span class="player-name">å°æ˜</span>è·å¾—å°¸æ£€æŠ¥å‘Šä¸€ä»½ï¼šæ­»è€…æ­»äºæ‘”å€’åå¤´éƒ¨ç€åœ°</p>
            </div>
            
            <div class="example">
                <p><span class="opponent-name">å°ç»¿</span>é€‰æ‹©<span class="emoji-preview">ğŸ¥®</span>ï¼šä»Šå¤©åƒäº†ä¸ªæœˆé¥¼ï¼Œå‘³é“è¿˜ä¸é”™</p>
                <p>â†’ æ— äº‹å‘ç”Ÿ</p>
            </div>
            
            <div class="example">
                <p><span class="player-name">å°æ˜</span>é€‰æ‹©<span class="emoji-preview">ğŸ§»</span>ï¼šæ†‹ä¸ä½äº†ï¼Œè¦å»å•æ‰€ï¼</p>
                <p>â†’ å€’éœ‰çš„<span class="player-name">å°æ˜</span>ä¸Šå•æ‰€æ—¶è¸©åˆ°åœ°ä¸Šçš„æ¹¿çº¸å·¾æ‘”æ­»ï¼Œä¸‹è¾ˆå­æ³¨æ„ç‚¹å§</p>
                <p><strong>æœ¬å±€æ¸¸æˆ<span class="opponent-name">å°ç»¿</span>èƒœå‡º</strong></p>
            </div>
        </div>
        
        <ul>
            <li>æ¸¸æˆå¼€å§‹æ—¶ï¼Œä¼šå±•ç¤º5x5ç½‘æ ¼çš„éšæœºç¥ç§˜ææ–™ï¼ˆemojiï¼‰<span class="emoji-preview">ğŸ§ªğŸ”®ğŸ„ğŸŒ¿ğŸ</span></li>
            <li>ç©å®¶å’Œç³»ç»Ÿéœ€è¦å„ç§˜å¯†é€‰æ‹©ä¸¤ä¸ªemojiï¼šä¸€ä¸ªä½œä¸º"æ­»æ³•"ï¼Œä¸€ä¸ªä½œä¸º"å°¸æ£€æŠ¥å‘Š"çš„éšè—åœ°ç‚¹</li>
            <li>ç©å®¶ç¡®è®¤é€‰æ‹©åï¼Œç‚¹å‡»"å¼€å§‹æ¸¸æˆ"æŒ‰é’®</li>
            <li>æ¸¸æˆå¼€å§‹åï¼Œç©å®¶å’Œç³»ç»Ÿè½®æµç‚¹å‡»æ ¼å­</li>
            <li>ç‚¹å‡»åçš„æ ¼å­ä¼šæ˜¾ç¤ºè¡ŒåŠ¨æ ‡è®°ï¼ˆP=ç©å®¶ï¼ŒS=ç³»ç»Ÿï¼‰</li>
            <li>å½“ç©å®¶ç‚¹å‡»åˆ°ç³»ç»Ÿçš„æ­»æ³•æ—¶ï¼Œå°†ä¼šæ­»äº¡å¹¶è¾“æ‰æ¸¸æˆ</li>
            <li>å½“ç³»ç»Ÿç‚¹å‡»åˆ°ç©å®¶çš„æ­»æ³•æ—¶ï¼Œç³»ç»Ÿæ­»äº¡ï¼Œç©å®¶è·èƒœ</li>
            <li>ç‚¹å‡»åˆ°"å°¸æ£€æŠ¥å‘Š"æ—¶ä¼šæ­ç¤ºéšè—çš„è‡´æ­»åŸå› </li>
            <li><strong>æ³¨æ„ï¼šæ¸¸æˆè¿‡ç¨‹ä¸­ä¸è¦é€éœ²è‡ªå·±çš„é€‰æ‹©ï¼</strong></li>
        </ul>
    </div>
    
    <div class="death-screen" id="deathScreen">
        <div class="death-content">
            <div class="death-message" id="deathMessage">ä½ æ­»äº†ï¼</div>
            <div class="death-reason" id="deathReason"></div>
            <button id="playAgainBtn"><i class="fas fa-undo"></i> å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        // æ¸¸æˆé…ç½® - ç¡®ä¿æ‰€æœ‰emojiéƒ½æ˜¯å”¯ä¸€çš„
        const GRID_SIZE = 5;
        const UNIQUE_EMOJIS = [
            'ğŸ¦', 'ğŸ”®', 'â›©', 'ğŸš²', 'â™Ÿ', 
            'ğŸ®', 'ğŸ±', 'ğŸ¥®', 'â„', 'ğŸ¡', 
            'ğŸ¦‹', 'ğŸ‘™', 'ğŸ“š', 'ğŸ›', 'ğŸ›', 
            'ğŸ§»', 'ğŸ§¬', 'ğŸ”«', 'ğŸ’¿', 'ğŸ“·', 
            'ğŸ–¥', 'ğŸ–', 'ğŸ§Š', 'ğŸ»', 'ğŸ·',
            'ğŸ§ª', 'â˜ ï¸', 'ğŸ•·ï¸', 'ğŸ¦‡', 'ğŸ',
            'ğŸ„', 'ğŸŒ¿', 'ğŸ', 'ğŸ•¯ï¸', 'âš—ï¸',
            'ğŸ§«', 'ğŸ¥€', 'ğŸŒ‘', 'ğŸ”¥', 'ğŸ’§',
            'ğŸŒªï¸', 'â˜£ï¸', 'â˜¢ï¸', 'ğŸ§­', 'ğŸ—ï¸'
        ];
        
        // æ¸¸æˆçŠ¶æ€å˜é‡
        let gameState = 'setup'; // setup, playing, ended
        let playerDeath = null;
        let playerAutopsy = null;
        let systemDeath = null;
        let systemAutopsy = null;
        let playerTurn = true;
        let cells = [];
        let logEntries = [];
        let emojiMap = {};
        
        // DOMå…ƒç´ 
        const gridElement = document.getElementById('grid');
        const gameStatusElement = document.getElementById('gameStatus');
        const deathEmojiElement = document.getElementById('deathEmoji');
        const deathDescElement = document.getElementById('deathDesc');
        const autopsyEmojiElement = document.getElementById('autopsyEmoji');
        const autopsyDescElement = document.getElementById('autopsyDesc');
        const startBtnElement = document.getElementById('startBtn');
        const resetBtnElement = document.getElementById('resetBtn');
        const logEntriesElement = document.getElementById('logEntries');
        const deathScreenElement = document.getElementById('deathScreen');
        const deathMessageElement = document.getElementById('deathMessage');
        const deathReasonElement = document.getElementById('deathReason');
        const playAgainBtnElement = document.getElementById('playAgainBtn');
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            createGrid();
            populateSelects();
            gameState = 'setup';
            playerDeath = null;
            playerAutopsy = null;
            systemDeath = null;
            systemAutopsy = null;
            playerTurn = true;
            logEntries = [];
            updateLog();
            gameStatusElement.textContent = "é€‰æ‹©ä½ çš„æ­»æ³•å’Œå°¸æ£€æŠ¥å‘Šä½ç½®...";
            deathDescElement.value = "";
            autopsyDescElement.value = "";
            deathScreenElement.style.display = "none";
            startBtnElement.disabled = true;
            
            addLog("æ¸¸æˆåˆå§‹åŒ–å®Œæˆï¼è¯·é€‰æ‹©ä½ çš„æ­»æ³•å’Œå°¸æ£€æŠ¥å‘Šä½ç½®ã€‚", "system-log");
        }
        
        // å¡«å……é€‰æ‹©æ¡†
        function populateSelects() {
            deathEmojiElement.innerHTML = '';
            autopsyEmojiElement.innerHTML = '';
            
            // æ·»åŠ é»˜è®¤é€‰é¡¹
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = '-- é€‰æ‹© --';
            deathEmojiElement.appendChild(defaultOption.cloneNode(true));
            autopsyEmojiElement.appendChild(defaultOption.cloneNode(true));
            
            // æ·»åŠ æ‰€æœ‰emojié€‰é¡¹
            Object.entries(emojiMap).forEach(([index, emoji]) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = emoji;
                
                deathEmojiElement.appendChild(option.cloneNode(true));
                autopsyEmojiElement.appendChild(option);
            });
            
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            deathEmojiElement.addEventListener('change', function() {
                updateCellSelections();
            });
            
            autopsyEmojiElement.addEventListener('change', function() {
                updateCellSelections();
            });
        }
        
        // æ›´æ–°æ ¼å­é€‰æ‹©çŠ¶æ€
        function updateCellSelections() {
            // æ¸…é™¤ä¹‹å‰çš„é€‰æ‹©æ ‡è®°
            cells.forEach(cell => {
                cell.element.classList.remove('death-selected', 'autopsy-selected');
            });
            
            // æ›´æ–°æ­»æ³•é€‰æ‹©
            if (deathEmojiElement.value) {
                const deathIndex = parseInt(deathEmojiElement.value);
                cells[deathIndex].element.classList.add('death-selected');
            }
            
            // æ›´æ–°å°¸æ£€æŠ¥å‘Šé€‰æ‹©
            if (autopsyEmojiElement.value) {
                const autopsyIndex = parseInt(autopsyEmojiElement.value);
                cells[autopsyIndex].element.classList.add('autopsy-selected');
            }
        }
        
        // åˆ›å»ºç½‘æ ¼
        function createGrid() {
            gridElement.innerHTML = '';
            cells = [];
            
            // éšæœºé€‰æ‹©25ä¸ªå”¯ä¸€çš„emoji
            const shuffledEmojis = [...UNIQUE_EMOJIS]
                .sort(() => Math.random() - 0.5)
                .slice(0, GRID_SIZE * GRID_SIZE);
            
            emojiMap = {};
            
            for (let i = 0; i < GRID_SIZE * GRID_SIZE; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.dataset.index = i;
                cell.textContent = shuffledEmojis[i];
                
                cell.addEventListener('click', () => handleCellClick(i));
                
                gridElement.appendChild(cell);
                cells.push({
                    element: cell,
                    index: i,
                    emoji: cell.textContent,
                    revealed: false,
                    revealedBy: null
                });
                
                // æ·»åŠ åˆ°emojiæ˜ å°„
                emojiMap[i] = cell.textContent;
            }
        }
        
        // å¤„ç†æ ¼å­ç‚¹å‡»
        function handleCellClick(index) {
            const cell = cells[index];
            
            if (gameState === 'ended' || cell.revealed) return;
            
            if (gameState === 'setup') {
                // åœ¨è®¾ç½®é˜¶æ®µé€‰æ‹©æ­»æ³•å’Œå°¸æ£€ä½ç½®
                if (!playerDeath) {
                    // é€‰æ‹©æ­»æ³•
                    playerDeath = index;
                    deathEmojiElement.value = index;
                    cell.element.classList.add('death-selected');
                    gameStatusElement.textContent = `å·²é€‰æ‹©æ­»æ³•: ${cell.emoji}ï¼Œç°åœ¨é€‰æ‹©å°¸æ£€æŠ¥å‘Šä½ç½®`;
                    addLog(`ä½ é€‰æ‹©äº†æ­»æ³•ä½ç½® ${cell.emoji}`, 'player-log');
                } else if (!playerAutopsy && index !== playerDeath) {
                    // é€‰æ‹©å°¸æ£€æŠ¥å‘Šä½ç½®
                    playerAutopsy = index;
                    autopsyEmojiElement.value = index;
                    cell.element.classList.add('autopsy-selected');
                    gameStatusElement.textContent = "å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»å¼€å§‹æ¸¸æˆ";
                    startBtnElement.disabled = false;
                    addLog(`ä½ é€‰æ‹©äº†å°¸æ£€æŠ¥å‘Šä½ç½® ${cell.emoji}`, 'player-log');
                }
            } else if (gameState === 'playing' && playerTurn) {
                // ç©å®¶å›åˆ
                revealCell(index, 'player');
                playerTurn = false;
                
                // ç”Ÿæˆç©å®¶è¡ŒåŠ¨æè¿°
                const action = getPlayerAction(cell.emoji);
                addLog(action, 'player-log');
                
                // æ£€æŸ¥æ¸¸æˆçŠ¶æ€
                if (index === systemDeath) {
                    endGame(false, `ä½ å‘ç°äº†ç³»ç»Ÿçš„æ­»æ³•${cell.emoji}ï¼Œä½†ä¸å¹¸èº«äº¡ï¼æ­»æ³•ï¼š${getSystemDeathDesc(cell.emoji)}`);
                    return;
                } else if (index === systemAutopsy) {
                    addLog(`ä½ å‘ç°äº†ç³»ç»Ÿçš„å°¸æ£€æŠ¥å‘Š${cell.emoji}ï¼è‡´æ­»åŸå› ï¼š${getSystemAutopsyDesc(cell.emoji)}`, 'autopsy-log');
                } else if (index === playerAutopsy) {
                    addLog(`ä½ å‘ç°äº†è‡ªå·±çš„å°¸æ£€æŠ¥å‘Š${cell.emoji}ï¼è‡´æ­»åŸå› ï¼š${autopsyDescElement.value}`, 'autopsy-log');
                }
                
                // ç³»ç»Ÿå›åˆï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼‰
                if (gameState === 'playing') {
                    gameStatusElement.textContent = "ç³»ç»Ÿæ­£åœ¨æ€è€ƒ...";
                    setTimeout(systemTurn, 2000);
                }
            }
        }
        
        // ç³»ç»Ÿå›åˆ
        function systemTurn() {
            if (gameState !== 'playing') return;
            
            // æ‰¾åˆ°æ‰€æœ‰æœªæ­ç¤ºçš„æ ¼å­
            const availableCells = cells.filter(cell => 
                !cell.revealed && 
                cell.index !== systemDeath && 
                cell.index !== systemAutopsy
            );
            
            if (availableCells.length === 0) {
                endGame(true, "æ‰€æœ‰ææ–™éƒ½å·²æ£€æŸ¥å®Œæ¯•ï¼Œæ— äººä¸­æ¯’ï¼");
                return;
            }
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªæ ¼å­
            const randomIndex = Math.floor(Math.random() * availableCells.length);
            const cellIndex = availableCells[randomIndex].index;
            const cell = cells[cellIndex];
            
            revealCell(cellIndex, 'system');
            playerTurn = true;
            gameStatusElement.textContent = "è½®åˆ°ä½ äº†ï¼Œå°å¿ƒé€‰æ‹©...";
            
            // ç”Ÿæˆç³»ç»Ÿè¡ŒåŠ¨æè¿°
            const action = getSystemAction(cell.emoji);
            addLog(action, 'system-log');
            
            // æ£€æŸ¥ç³»ç»Ÿé€‰æ‹©çš„æ ¼å­
            if (cellIndex === playerDeath) {
                endGame(true, `ç³»ç»Ÿè¯¯è§¦äº†ä½ çš„æ­»æ³•${cell.emoji}ï¼Œä½ è·å¾—äº†èƒœåˆ©ï¼æ­»æ³•ï¼š${deathDescElement.value}`);
            } else if (cellIndex === playerAutopsy) {
                addLog(`ç³»ç»Ÿå‘ç°äº†ä½ çš„å°¸æ£€æŠ¥å‘Š${cell.emoji}ï¼è‡´æ­»åŸå› ï¼š${autopsyDescElement.value}`, 'autopsy-log');
            } else if (cellIndex === systemAutopsy) {
                addLog(`ç³»ç»Ÿå‘ç°äº†è‡ªå·±çš„å°¸æ£€æŠ¥å‘Š${cell.emoji}ï¼è‡´æ­»åŸå› ï¼š${getSystemAutopsyDesc(cell.emoji)}`, 'autopsy-log');
            }
        }
        
        // æ­ç¤ºæ ¼å­
        function revealCell(index, by) {
            const cell = cells[index];
            cell.revealed = true;
            cell.revealedBy = by;
            cell.element.classList.add('revealed');
            
            // ç§»é™¤é€‰æ‹©æ ‡è®°
            cell.element.classList.remove('death-selected', 'autopsy-selected');
            
            // æ·»åŠ è¡ŒåŠ¨æ ‡è®°
            if (by === 'player') {
                cell.element.classList.add('player-move');
            } else {
                cell.element.classList.add('system-move');
            }
            
            cell.element.style.cursor = 'default';
        }
        
        // ç©å®¶è¡ŒåŠ¨æè¿°ç”Ÿæˆ
        function getPlayerAction(emoji) {
            const actions = {
                'ğŸ¦': "èµ°è¿›é“¶è¡Œå‡†å¤‡å–é’±ï¼Œå‘ç°é“¶è¡Œå¡å¤ªä¹…ä¸ä½¿ç”¨ï¼Œè¢«å†»ç»“äº†...",
                'ğŸ”®': "ä»Šå¤©å»é€›å¸‚é›†ï¼Œæ‰¾å¥³å·«ç®—äº†ä¸€å¦",
                'â›©': "åœ¨ç¥ç¤¾è®¸æ„¿ï¼šå¸Œæœ›æ˜å¤©ä¸è¦ä¸‹é›¨ï¼",
                'ğŸš²': "ä»Šå¤©æ—©ä¸Šé€šå‹¤çš„å…±äº«å•è½¦ï¼Œåå«è¿˜æŒºèˆ’æœï½",
                'â™Ÿ': "è„‘æµ·ä¸­æµ®ç°å‡ºç½—æ©åœ¨å·«å¸ˆæ£‹å¤§æˆ˜ä¸­ä¸ºä¼™ä¼´ç‰ºç‰²çš„å´‡é«˜ç”»é¢ï¼Œå˜¤å˜¤å˜¤",
                'ğŸ®': "å¤å¤©æ¥äº†ï¼Œæˆ‘æƒ³ç©ç§èœæ¸¸æˆå‘¢ï¼Œå“ˆå“ˆå“ˆå“ˆ",
                'ğŸ±': "æ•™ç»ƒï¼æˆ‘æƒ³æ‰“å°çƒï¼ï¼ï¼",
                'ğŸ¥®': "çªç„¶æœ‰ç‚¹æƒ³åƒäº”ä»æœˆé¥¼ï½",
                'â„': "å †ä¸ªé›ªäººå§ï¼èƒ¡èåœå½“é¼»å­æœ€åˆé€‚äº†ï¼",
                'ğŸ¡': "æ²³è±šåˆºèº«çœ‹èµ·æ¥å¾ˆç¾å‘³ï¼Œä½†ä¼šä¸ä¼šæœ‰æ¯’å‘¢ï¼Ÿ",
                'ğŸ¦‹': "è´è¶æ•ˆåº”ï¼Œå¥½ææ€–çš„erï½",
                'ğŸ‘™': "è¿™ä»¶æ³³è£…çœŸå¥½çœ‹ï¼Œä½†ä»·æ ¼ä¹Ÿå¤ªè´µäº†å§ï¼",
                'ğŸ“š': "è¿™æœ¬ä¹¦çœŸåšï¼Œä»€ä¹ˆæ—¶å€™æ‰èƒ½è¯»å®Œå•Šï¼Ÿ",
                'ğŸ›': "è¿™å¼ åºŠå¥½èˆ’æœï¼ŒçœŸæƒ³å†ç¡äº”åˆ†é’Ÿ...",
                'ğŸ›': "æ³¡ä¸ªçƒ­æ°´æ¾¡ï¼Œæ”¾ç‚¹ç«ç‘°èŠ±ç“£ï½",
                'ğŸ§»': "å¿½ç„¶æœ‰ç‚¹å±æ„ç›ç„¶...",
                'ğŸ§¬': "ç ”ç©¶DNAç»“æ„ï¼Œå‘ç°ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼",
                'ğŸ”«': "æ°´æªå¤§æˆ˜å¼€å§‹ï¼çœ‹æˆ‘çš„å‰å®³ï¼",
                'ğŸ’¿': "æ‹¿å‡ºäº†ä¸€å¼ äº®é—ªé—ªçš„å…‰ç›˜ï¼Œå‘ç°æˆ‘çš„ç”µè„‘æ²¡æœ‰å…‰é©±ï½ï½ï½",
                'ğŸ“·': "è‡ªæ‹æ—¶é—´ï¼æ‰¾ä¸ªå¥½è§’åº¦ï½",
                'ğŸ–¥': "åˆå†™äº†ä¸€å¤©ä»£ç ï¼Œçœ¼ç›å¥½é…¸...",
                'ğŸ–': "æœ‰çš„æ—¶å€™ä¹Ÿæƒ³å»ææåº¦å‡ï¼ï¼ï¼",
                'ğŸ§Š': "æƒ…ç»ªæ¥äº†ï¼Œåšäº†ä¸€æ¯è±ªåå†°é•‡èœœæ¡ƒæ°”æ³¡æ°´",
                'ğŸ»': "ç»ƒä¹ å°æç´ï¼Œé‚»å±…åˆæ¥æ•²é—¨äº†...",
                'ğŸ·': "æœ€è¿‘æœ‰ç‚¹æƒ³å–å°é…’ï½",
                'ğŸ§ª': "è°ƒåˆ¶ç¥ç§˜è¯æ°´ï¼Œå¸Œæœ›ä¸è¦çˆ†ç‚¸...",
                'â˜ ï¸': "éª·é«…å¤´é¡¹é“¾ï¼Œæˆ´ä¸Šå®ƒæ˜¾å¾—å¾ˆé…·ï¼",
                'ğŸ•·ï¸': "èœ˜è››ä¾ ï¼æˆ‘ä¹Ÿæƒ³æ‹¥æœ‰è¶…èƒ½åŠ›ï¼",
                'ğŸ¦‡': "è™è ä¾ çš„è£…å¤‡çœŸå¸…ï¼Œæˆ‘ä¹Ÿæƒ³è¦ï¼",
                'ğŸ': "ç™½é›ªå…¬ä¸»çš„æ¯’è‹¹æœï¼Ÿçœ‹èµ·æ¥å¾ˆå¥½åƒï¼",
                'ğŸ„': "è¿™ä¸ªè˜‘è‡å¥½æ¼‚äº®ï¼Œä½†ä¸çŸ¥é“èƒ½ä¸èƒ½åƒ...",
                'ğŸŒ¿': "è¿™äº›è‰è¯èƒ½æ²»æ„Ÿå†’å—ï¼Ÿè¯•è¯•çœ‹ï¼",
                'ğŸ': "è›‡çš„ç§»åŠ¨æ–¹å¼çœŸç¥å¥‡ï¼",
                'ğŸ•¯ï¸': "çƒ›å…‰æ™šé¤ï¼Œæ°”æ°›æ»¡åˆ†ï¼",
                'âš—ï¸': "åŒ–å­¦å®éªŒï¼Œå¸Œæœ›ä¸è¦å‡ºäº‹æ•…..."
            };
            
            return actions[emoji] || `ä½ ä»”ç»†ç ”ç©¶äº†${emoji}ï¼Œå‘ç°äº†ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿...`;
        }
        
        // ç³»ç»Ÿè¡ŒåŠ¨æè¿°ç”Ÿæˆ
        function getSystemAction(emoji) {
            const actions = {
                'ğŸ¦': "ç³»ç»Ÿæ­£åœ¨åˆ†æé“¶è¡Œå®‰å…¨ç³»ç»Ÿ...",
                'ğŸ”®': "ç³»ç»Ÿé¢„æµ‹æ˜å¤©çš„å¤©æ°”ä¼šæ˜¯æ™´å¤©ï¼",
                'â›©': "ç³»ç»Ÿè¯„ä¼°ç¥ç¤¾å»ºç­‘ç»“æ„çš„ç¨³å®šæ€§...",
                'ğŸš²': "ç³»ç»Ÿè®¡ç®—è‡ªè¡Œè½¦çš„æœ€ä½³è¡Œé©¶è·¯çº¿...",
                'â™Ÿ': "ç³»ç»Ÿæ€è€ƒæ£‹å±€ï¼Œå‡†å¤‡ä¸‹ä¸€æ­¥å°†å†›ï¼",
                'ğŸ®': "ç³»ç»Ÿå¯åŠ¨æ¸¸æˆç¨‹åºï¼Œå‡†å¤‡å¤§æ€å››æ–¹ï¼",
                'ğŸ±': "ç³»ç»Ÿè®¡ç®—å°çƒçš„è§’åº¦å’ŒåŠ›åº¦...",
                'ğŸ¥®': "ç³»ç»Ÿåˆ†ææœˆé¥¼çš„è¥å…»æˆåˆ†...",
                'â„': "ç³»ç»Ÿæµ‹é‡é›ªçš„æ¸©åº¦å’Œå¯†åº¦...",
                'ğŸ¡': "ç³»ç»Ÿæ£€æµ‹æ²³è±šçš„æ¯’æ€§ç­‰çº§...",
                'ğŸ¦‹': "ç³»ç»Ÿè®°å½•è´è¶çš„é£è¡Œè½¨è¿¹...",
                'ğŸ‘™': "ç³»ç»Ÿè¯„ä¼°æ³³è£…çš„ææ–™å’Œè®¾è®¡...",
                'ğŸ“š': "ç³»ç»Ÿæ‰«æä¹¦ç±å†…å®¹ï¼Œå»ºç«‹ç´¢å¼•...",
                'ğŸ›': "ç³»ç»Ÿæµ‹è¯•åºŠå«çš„èˆ’é€‚åº¦...",
                'ğŸ›': "ç³»ç»Ÿè°ƒèŠ‚æ°´æ¸©è‡³æœ€ä½³æ³¡æ¾¡æ¸©åº¦...",
                'ğŸ§»': "ç³»ç»Ÿè®¡ç®—å•çº¸çš„ä½¿ç”¨å¯¿å‘½...",
                'ğŸ§¬': "ç³»ç»Ÿè§£ç DNAåºåˆ—...",
                'ğŸ”«': "ç³»ç»Ÿæ ¡å‡†æ°´æªçš„å°„ç¨‹...",
                'ğŸ’¿': "ç³»ç»Ÿè¯»å–å…‰ç›˜æ•°æ®ï¼Œè¿›åº¦50%...",
                'ğŸ“·': "ç³»ç»Ÿè°ƒæ•´ç›¸æœºå‚æ•°ï¼Œå‡†å¤‡æ‹ç…§...",
                'ğŸ–¥': "ç³»ç»Ÿä¼˜åŒ–ä»£ç ï¼Œæå‡è¿è¡Œæ•ˆç‡...",
                'ğŸ–': "ç³»ç»Ÿç›‘æµ‹ç´«å¤–çº¿å¼ºåº¦ï¼Œå»ºè®®ä½¿ç”¨é˜²æ™’éœœ...",
                'ğŸ§Š': "ç³»ç»Ÿè®¡ç®—å†°å—çš„èåŒ–é€Ÿåº¦...",
                'ğŸ»': "ç³»ç»Ÿè°ƒéŸ³ï¼Œå‡†å¤‡æ¼”å¥å°å¤œæ›²...",
                'ğŸ·': "ç³»ç»Ÿåˆ†æçº¢é…’çš„å¹´ä»½å’Œäº§åœ°...",
                'ğŸ§ª': "ç³»ç»Ÿæ··åˆåŒ–å­¦è¯•å‰‚ï¼Œååº”ä¸­...",
                'â˜ ï¸': "ç³»ç»Ÿåˆ†æéª·é«…å¤´çš„ç»“æ„...",
                'ğŸ•·ï¸': "ç³»ç»Ÿç ”ç©¶èœ˜è››çš„ç»“ç½‘æ¨¡å¼...",
                'ğŸ¦‡': "ç³»ç»Ÿè¿½è¸ªè™è çš„å£°æ³¢ä¿¡å·...",
                'ğŸ': "ç³»ç»Ÿæ£€æµ‹è‹¹æœçš„å†œè¯æ®‹ç•™...",
                'ğŸ„': "ç³»ç»Ÿåˆ†ç±»è˜‘è‡ç§ç±»ï¼Œæœ‰æ¯’/æ— æ¯’...",
                'ğŸŒ¿': "ç³»ç»Ÿæå–è‰è¯ä¸­çš„æœ‰æ•ˆæˆåˆ†...",
                'ğŸ': "ç³»ç»Ÿç ”ç©¶è›‡çš„è¿åŠ¨æ¨¡å¼...",
                'ğŸ•¯ï¸': "ç³»ç»Ÿæµ‹é‡èœ¡çƒ›çš„ç‡ƒçƒ§é€Ÿåº¦...",
                'âš—ï¸': "ç³»ç»Ÿè¿›è¡ŒåŒ–å­¦å®éªŒï¼Œç”ŸæˆæŠ¥å‘Š..."
            };
            
            return actions[emoji] || `ç³»ç»Ÿæ­£åœ¨ç ”ç©¶${emoji}...`;
        }
        
        // ç³»ç»Ÿæ­»æ³•æè¿°ç”Ÿæˆï¼ˆåŸºäºemojiï¼‰
        function getSystemDeathDesc(emoji) {
            const descriptions = {
                'ğŸ¦': "å»é“¶è¡Œå–é’±æ—¶é‡åˆ°æŠ¢åŠ«ï¼Œè¢«åŠ«åŒªå½“ä½œäººè´¨ï¼Œæœ€åè¢«è­¦å¯Ÿè¯¯ä¼¤ã€‚",
                'ğŸ”®': "å·çœ‹å¥³å·«çš„æ°´æ™¶çƒæ—¶ï¼Œè¢«æœªæ¥çš„è‡ªå·±å“åˆ°å¿ƒè„ç—…å‘ä½œã€‚",
                'â›©': "åœ¨ç¥ç¤¾ç¥ˆç¦æ—¶ï¼Œè¢«æ‰è½çš„è®¸æ„¿ç‰Œç ¸ä¸­å¤´éƒ¨ã€‚",
                'ğŸš²': "éª‘è‡ªè¡Œè½¦ä¸‹å¡æ—¶åˆ¹è½¦å¤±çµï¼Œæ’ä¸Šå†°æ·‡æ·‹è½¦ã€‚",
                'â™Ÿ': "å‚åŠ å›½é™…è±¡æ£‹é”¦æ ‡èµ›æ—¶ï¼Œè¢«å¯¹æ‰‹ç”¨æ£‹å­å‡»ä¸­å¤ªé˜³ç©´ã€‚",
                'ğŸ®': "è¿ç»­æ¸¸æˆ72å°æ—¶åï¼Œè¢«è™šæ‹Ÿæ€ªç‰©å“åˆ°å¿ƒè„éª¤åœã€‚",
                'ğŸ±': "åœ¨å°çƒæ¯”èµ›ä¸­ï¼Œè¢«å¯¹æ‰‹ç”¨å…«å·çƒå‡»ä¸­è¦å®³ã€‚",
                'ğŸ¥®': "åƒæœˆé¥¼æ—¶è¢«é‡Œé¢çš„é‡‘å—å¡ä½å–‰å’™çª’æ¯ã€‚",
                'â„': "åœ¨å†°é›ªå¤§ä¸–ç•Œç©è€çš„æ—¶å€™ï¼Œä¸å°å¿ƒæ’åˆ°äº†é›ªç‹æ€€é‡Œï¼ŒèˆŒå¤´å†»åœ¨äº†é›ªç‹çš„ç”œç­’æƒæ–ä¸Šã€‚",
                'ğŸ¡': "å°è¯•åƒæ²³è±šåˆºèº«ï¼Œå¨å¸ˆå¤„ç†ä¸å½“å¯¼è‡´ä¸­æ¯’ã€‚",
                'ğŸ¦‹': "éª‘è‡ªè¡Œè½¦å»åœ°é“ç«™çš„è·¯ä¸Šï¼Œå¸å…¥äº†è´è¶æŠ–è½çš„èŠ±ç²‰è¿‡æ•ï¼Œåœ¨è½¬å¼¯å¤„ç¿»è½¦ï¼Œå› è½¦ç¥¸è€Œæ­»ã€‚",
                'ğŸ‘™': "æ¸¸æ³³çš„æ—¶å€™ï¼Œè¢«ç†Šå­©å­è¶…å¤§åŠ›åœ°è¸¹ä¸­ï¼Œå†…è„ç ´è£‚ï¼Œä¸æ²»èº«äº¡ã€‚",
                'ğŸ“š': "åœ¨å›¾ä¹¦é¦†çœ‹ä¹¦æ—¶ï¼Œè¢«å€’å¡Œçš„ä¹¦æ¶ç ¸ä¸­ã€‚",
                'ğŸ›': "åœ¨åºŠä¸Šè·³è¹¦åºŠæ—¶ï¼Œæ’ä¸Šå¤©èŠ±æ¿åŠç¯ã€‚",
                'ğŸ›': "æ³¡æ¾¡æ—¶ç¡ç€ï¼Œæ·¹æ­»åœ¨æµ´ç¼¸é‡Œã€‚",
                'ğŸ§»': "ä¸Šå•æ‰€æ—¶è¸©åˆ°åœ°ä¸Šçš„æ¹¿çº¸å·¾æ‘”æ­»ã€‚",
                'ğŸ§¬': "åšDNAå®éªŒæ—¶ï¼Œè¢«çªå˜ç»†èŒæ„ŸæŸ“ã€‚",
                'ğŸ”«': "ç©æ°´æªæ—¶ï¼Œè¢«è¯¯è®¤ä¸ºæ˜¯çœŸæªè€Œé­å°„å‡»ã€‚",
                'ğŸ’¿': "å¬CDæ—¶è¢«é£å‡ºçš„å…‰ç›˜åˆ’ä¼¤åŠ¨è„‰ã€‚",
                'ğŸ“·': "è‡ªæ‹æ—¶è¢«é—ªç”µå‡»ä¸­ã€‚",
                'ğŸ–¥': "ç”¨ç”µè„‘æ—¶è¢«é»‘å®¢å…¥ä¾µå¿ƒè„èµ·æå™¨ã€‚",
                'ğŸ–': "åœ¨æ²™æ»©æ™’å¤ªé˜³æ—¶è¢«å¯„å±…èŸ¹é’»è¿›è€³æœµã€‚",
                'ğŸ§Š': "åƒå†°å—æ—¶è¢«å†»ä½èˆŒå¤´çª’æ¯ã€‚",
                'ğŸ»': "æ‹‰å°æç´æ—¶ç´å¼¦æ–­è£‚å‰²å–‰ã€‚",
                'ğŸ·': "å–çº¢é…’æ—¶è¢«é…’ç“¶å¡å­å™ä½ã€‚",
                'ğŸ§ª': "è°ƒåˆ¶é­”è¯æ—¶å‘ç”Ÿçˆ†ç‚¸ï¼Œè¢«ç»¿è‰²æ¶²ä½“æº¶è§£ã€‚",
                'â˜ ï¸': "æˆ´ç€éª·é«…å¤´é¡¹é“¾ç¡è§‰ï¼Œè¢«è¯…å’’è€Œæ­»ã€‚",
                'ğŸ•·ï¸': "è¢«å‰§æ¯’èœ˜è››å’¬ä¼¤ï¼Œå…¨èº«æºƒçƒ‚è€Œäº¡ã€‚",
                'ğŸ¦‡': "è¢«å¸è¡€è™è ç¾¤è¢­å‡»ï¼Œå¤±è¡€è¿‡å¤šã€‚",
                'ğŸ': "åƒäº†ä¸€å£æ¯’è‹¹æœï¼Œåƒç™½é›ªå…¬ä¸»ä¸€æ ·é•¿çœ ä¸é†’ã€‚",
                'ğŸ„': "è¯¯é£Ÿæ¯’è˜‘è‡ï¼Œäº§ç”Ÿå¹»è§‰è·³ä¸‹æ‚¬å´–ã€‚",
                'ğŸŒ¿': "åƒè‰è¯è¿‡é‡ï¼Œå˜æˆäº†ä¸€æ ªæ¤ç‰©ã€‚",
                'ğŸ': "è¢«æ¯’è›‡å’¬ä¼¤ï¼Œæ¯’å‘èº«äº¡ã€‚",
                'ğŸ•¯ï¸': "åœ¨çƒ›å…‰æ™šé¤æ—¶ï¼Œå¤´å‘è¢«ç‚¹ç‡ƒã€‚",
                'âš—ï¸': "åŒ–å­¦å®éªŒå‡ºé”™ï¼Œè¢«ç´«è‰²çƒŸé›¾æ¯’æ­»ã€‚"
            };
            
            return descriptions[emoji] || `åœ¨ä½¿ç”¨${emoji}æ—¶å‘ç”Ÿäº†æ„å¤–ï¼Œä¸å¹¸èº«äº¡ã€‚`;
        }
        
        // ç³»ç»Ÿå°¸æ£€æŠ¥å‘Šæè¿°ç”Ÿæˆï¼ˆåŸºäºemojiï¼‰
        function getSystemAutopsyDesc(emoji) {
            const descriptions = {
                'ğŸ¦': "æ­»è€…æ­»äºå¤šå¤„æªä¼¤ã€‚",
                'ğŸ”®': "æ­»è€…æ­»äºå¿ƒè„ç—…å‘ä½œã€‚",
                'â›©': "æ­»è€…æ­»äºé¢…è„‘æŸä¼¤ã€‚",
                'ğŸš²': "æ­»è€…æ­»äºå¤šå¤„éª¨æŠ˜å’Œå†…è„ç ´è£‚ã€‚",
                'â™Ÿ': "æ­»è€…æ­»äºå¤ªé˜³ç©´å—åˆ°é‡å‡»ã€‚",
                'ğŸ®': "æ­»è€…æ­»äºå¿ƒè„éª¤åœã€‚",
                'ğŸ±': "æ­»è€…æ­»äºé’å™¨å‡»æ‰“è¦å®³ã€‚",
                'ğŸ¥®': "æ­»è€…æ­»äºå‘¼å¸é“é˜»å¡ã€‚",
                'â„': "æ­»è€…æ­»äºçª’æ¯å’Œä½æ¸©ç—‡ã€‚",
                'ğŸ¡': "æ­»è€…æ­»äºæ²³è±šæ¯’ç´ ã€‚",
                'ğŸ¦‹': "æ­»è€…æ­»äºé«˜å¤„å è½ã€‚",
                'ğŸ‘™': "æ­»è€…æ­»äºæººæ°´ã€‚",
                'ğŸ“š': "æ­»è€…æ­»äºé¢…è„‘æŸä¼¤å’Œé¢ˆæ¤æ–­è£‚ã€‚",
                'ğŸ›': "æ­»è€…æ­»äºç”µå‡»ä¼¤ã€‚",
                'ğŸ›': "æ­»è€…æ­»äºæººæ°´ã€‚",
                'ğŸ§»': "æ­»è€…æ­»äºå¤´éƒ¨é‡ä¼¤ã€‚",
                'ğŸ§¬': "æ­»è€…æ­»äºç»†èŒæ„ŸæŸ“ã€‚",
                'ğŸ”«': "æ­»è€…æ­»äºæªä¼¤ã€‚",
                'ğŸ’¿': "æ­»è€…æ­»äºåŠ¨è„‰ç ´è£‚ã€‚",
                'ğŸ“·': "æ­»è€…æ­»äºç”µå‡»ä¼¤ã€‚",
                'ğŸ–¥': "æ­»è€…æ­»äºå¿ƒè„èµ·æå™¨æ•…éšœã€‚",
                'ğŸ–': "æ­»è€…æ­»äºè„‘éƒ¨å¯„ç”Ÿè™«æ„ŸæŸ“ã€‚",
                'ğŸ§Š': "æ­»è€…æ­»äºçª’æ¯ã€‚",
                'ğŸ»': "æ­»è€…æ­»äºé¢ˆåŠ¨è„‰ç ´è£‚ã€‚",
                'ğŸ·': "æ­»è€…æ­»äºå‘¼å¸é“é˜»å¡ã€‚",
                'ğŸ§ª': "æ­»è€…æ­»äºåŒ–å­¦ä¸­æ¯’ã€‚",
                'â˜ ï¸': "æ­»è€…æ­»äºä¸æ˜è¯…å’’ã€‚",
                'ğŸ•·ï¸': "æ­»è€…æ­»äºç¥ç»æ¯’ç´ ã€‚",
                'ğŸ¦‡': "æ­»è€…æ­»äºå¤±è¡€è¿‡å¤šã€‚",
                'ğŸ': "æ­»è€…æ­»äºæ°°åŒ–ç‰©ä¸­æ¯’ã€‚",
                'ğŸ„': "æ­»è€…æ­»äºå¹»è§‰å¯¼è‡´çš„è‡ªä¼¤ã€‚",
                'ğŸŒ¿': "æ­»è€…æ­»äºæ¤ç‰©æ¯’ç´ ã€‚",
                'ğŸ': "æ­»è€…æ­»äºè›‡æ¯’ã€‚",
                'ğŸ•¯ï¸': "æ­»è€…æ­»äºçƒ§ä¼¤ã€‚",
                'âš—ï¸': "æ­»è€…æ­»äºåŒ–å­¦ä¸­æ¯’ã€‚"
            };
            
            return descriptions[emoji] || `æ­»è€…åœ¨ä½¿ç”¨${emoji}æ—¶å‘ç”Ÿæ„å¤–èº«äº¡ã€‚`;
        }
        
        // æ·»åŠ æ—¥å¿—
        function addLog(message, className) {
            logEntries.push({ message, className });
            if (logEntries.length > 20) logEntries.shift();
            updateLog();
        }
        
        // æ›´æ–°æ—¥å¿—
        function updateLog() {
            logEntriesElement.innerHTML = '';
            logEntries.forEach(entry => {
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${entry.className}`;
                
                const icon = document.createElement('span');
                icon.style.marginRight = '10px';
                
                if (entry.className === 'player-log') {
                    icon.innerHTML = '<i class="fas fa-user"></i>';
                } else if (entry.className === 'system-log') {
                    icon.innerHTML = '<i class="fas fa-robot"></i>';
                } else {
                    icon.innerHTML = '<i class="fas fa-file-medical"></i>';
                }
                
                logEntry.appendChild(icon);
                logEntry.appendChild(document.createTextNode(entry.message));
                logEntriesElement.appendChild(logEntry);
            });
            logEntriesElement.scrollTop = logEntriesElement.scrollHeight;
        }
        
        // ç»“æŸæ¸¸æˆ
        function endGame(isWin, message) {
            gameState = 'ended';
            
            if (isWin) {
                deathMessageElement.textContent = "ä½ èµ¢äº†ï¼ğŸ‰";
                deathMessageElement.style.color = "#4caf50";
            } else {
                deathMessageElement.textContent = "ä½ æ­»äº†ï¼ğŸ’€";
                deathMessageElement.style.color = "#ff6b6b";
            }
            
            deathReasonElement.textContent = message;
            deathScreenElement.style.display = "flex";
            
            // æ­ç¤ºæ‰€æœ‰ç³»ç»Ÿé€‰æ‹©
            if (systemDeath !== null) {
                revealCell(systemDeath, 'system');
            }
            if (systemAutopsy !== null) {
                revealCell(systemAutopsy, 'system');
            }
        }
        
        // ç³»ç»Ÿéšæœºé€‰æ‹©ä½ç½®
        function makeSystemSelections() {
            // ç³»ç»Ÿé€‰æ‹©æ­»æ³•ä½ç½®ï¼ˆé¿å¼€ç©å®¶é€‰æ‹©ï¼‰
            let availableCells = cells
                .map((_, i) => i)
                .filter(i => i !== playerDeath && i !== playerAutopsy);
            
            systemDeath = availableCells[Math.floor(Math.random() * availableCells.length)];
            availableCells = availableCells.filter(i => i !== systemDeath);
            systemAutopsy = availableCells[Math.floor(Math.random() * availableCells.length)];
            
            addLog("ç³»ç»Ÿå·²ç§˜å¯†å¸ƒç½®å¥½æ­»æ³•å’Œå°¸æ£€æŠ¥å‘Šä½ç½®...", 'system-log');
            addLog("æ¸¸æˆå¼€å§‹ï¼è½®åˆ°ä½ è¡ŒåŠ¨ï¼Œå°å¿ƒé€‰æ‹©...", 'system-log');
        }
        
        // äº‹ä»¶ç›‘å¬å™¨
        startBtnElement.addEventListener('click', () => {
            if (!deathEmojiElement.value || !autopsyEmojiElement.value) {
                alert("è¯·é€‰æ‹©æ­»æ³•å’Œå°¸æ£€æŠ¥å‘Šä½ç½®ï¼");
                return;
            }
            
            playerDeath = parseInt(deathEmojiElement.value);
            playerAutopsy = parseInt(autopsyEmojiElement.value);
            
            if (!deathDescElement.value || !autopsyDescElement.value) {
                alert("è¯·å¡«å†™æ­»äº¡åœºæ™¯å’Œå°¸æ£€æŠ¥å‘Šæè¿°ï¼");
                return;
            }
            
            if (playerDeath === playerAutopsy) {
                alert("æ­»æ³•å’Œå°¸æ£€æŠ¥å‘Šä½ç½®ä¸èƒ½ç›¸åŒï¼");
                return;
            }
            
            gameState = 'playing';
            makeSystemSelections();
            gameStatusElement.textContent = "æ¸¸æˆå¼€å§‹ï¼è½®åˆ°ä½ è¡ŒåŠ¨...";
            startBtnElement.disabled = true;
            
            // æ ‡è®°ç©å®¶é€‰æ‹©çš„ä½ç½®
            cells[playerDeath].element.classList.add('death-selected');
            cells[playerAutopsy].element.classList.add('autopsy-selected');
        });
        
        resetBtnElement.addEventListener('click', initGame);
        playAgainBtnElement.addEventListener('click', initGame);
        
        // åˆå§‹åŒ–æ¸¸æˆ
        initGame();
    </script>
</body>
</html>
